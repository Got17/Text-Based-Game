(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))m(d);new MutationObserver(d=>{for(const M of d)if(M.type==="childList")for(const g of M.addedNodes)g.tagName==="LINK"&&g.rel==="modulepreload"&&m(g)}).observe(document,{childList:!0,subtree:!0});function w(d){const M={};return d.integrity&&(M.integrity=d.integrity),d.referrerPolicy&&(M.referrerPolicy=d.referrerPolicy),d.crossOrigin==="use-credentials"?M.credentials="include":d.crossOrigin==="anonymous"?M.credentials="omit":M.credentials="same-origin",M}function m(d){if(d.ep)return;d.ep=!0;const M=w(d);fetch(d.href,M)}})();document.write(`<!--[if lte IE 11.0]>
<![endif]-->
<!--[if lte IE 9.0]>
<![endif]-->
`);(function(h){Date.now||(Date.now=function(){return new Date().getTime()}),Math.trunc||(Math.trunc=function(s){return s<0?Math.ceil(s):Math.floor(s)}),Object.setPrototypeOf||(Object.setPrototypeOf=function(s,w){return s.__proto__=w,s}),h.WebSharper={Runtime:{Ctor:function(s,w){return s.prototype=w.prototype,s},Class:function(s,w,m){var d=s,M,g,le;if(w){d=new w;for(M in s)d[M]=s[M]}if(g=function(z){if(z)for(var Ct in z)this[Ct]=z[Ct]},g.prototype=d,m)for(le in m)g[le]=m[le];return g},Clone:function(s){var w={};for(var m of Object.getOwnPropertyNames(s))w[m]=s[m];return Object.setPrototypeOf(w,Object.getPrototypeOf(s)),w},NewObject:function(s){for(var w={},m=0;m<s.length;m++)w[s[m][0]]=s[m][1];return w},PrintObject:function(s){var w="{ ",m=!0;for(var d of Object.getOwnPropertyNames(s))m?m=!1:w+=", ",w+=d+" = "+s[d];return w+(m?"}":" }")},DeleteEmptyFields:function(s,w){for(var m,d=0;d<w.length;d++)m=w[d],s[m]===void 0&&delete s[m];return s},GetOptional:function(s){return s===void 0?null:{$:1,$0:s}},SetOptional:function(s,w,m){m?s[w]=m.$0:delete s[w]},SetOrDelete:function(s,w,m){m===void 0?delete s[w]:s[w]=m},Apply:function(s,w,m){return s.apply(w,m)},Bind:function(s){return function(){return s.apply(this,arguments)}},CreateFuncWithArgs:function(s){return function(){return s(Array.prototype.slice.call(arguments))}},CreateFuncWithOnlyThis:function(s){return function(){return s(this)}},CreateFuncWithThis:function(s){return function(){return s(this).apply(null,arguments)}},CreateFuncWithThisArgs:function(s){return function(){return s(this)(Array.prototype.slice.call(arguments))}},CreateFuncWithRest:function(s,w){return function(){return w(Array.prototype.slice.call(arguments,0,s).concat([Array.prototype.slice.call(arguments,s)]))}},CreateFuncWithArgsRest:function(s,w){return function(){return w([Array.prototype.slice.call(arguments,0,s),Array.prototype.slice.call(arguments,s)])}},BindDelegate:function(s,w){var m=s.bind(w);return m.$Func=s,m.$Target=w,m},CreateDelegate:function(s){if(s.length==0)return null;if(s.length==1)return s[0];var w=function(){for(var m,d=0;d<s.length;d++)m=s[d].apply(null,arguments);return m};return w.$Invokes=s,w},CombineDelegates:function(s){for(var w,m=[],d=0;d<s.length;d++)w=s[d],w&&("$Invokes"in w?m=m.concat(w.$Invokes):m.push(w));return WebSharper.Runtime.CreateDelegate(m)},DelegateEqual:function(s,w){var m,d,M,g,le;if(s===w)return!0;if(s==null||w==null||(m=s.$Invokes||[s],d=w.$Invokes||[w],m.length!=d.length))return!1;for(M=0;M<m.length;M++)if(g=m[M],le=d[M],!(g===le||"$Func"in g&&"$Func"in le&&g.$Func===le.$Func&&g.$Target==le.$Target))return!1;return!0},ThisFunc:function(s){return function(){var w=Array.prototype.slice.call(arguments);return w.unshift(this),s.apply(null,w)}},ThisFuncOut:function(s){return function(){var w=Array.prototype.slice.call(arguments);return s.apply(w.shift(),w)}},ParamsFunc:function(s,w){return function(){var m=Array.prototype.slice.call(arguments);return w.apply(null,m.slice(0,s).concat([m.slice(s)]))}},ParamsFuncOut:function(s,w){return function(){var m=Array.prototype.slice.call(arguments);return w.apply(null,m.slice(0,s).concat(m[s]))}},ThisParamsFunc:function(s,w){return function(){var m=Array.prototype.slice.call(arguments);return m.unshift(this),w.apply(null,m.slice(0,s+1).concat([m.slice(s+1)]))}},ThisParamsFuncOut:function(s,w){return function(){var m=Array.prototype.slice.call(arguments);return w.apply(m.shift(),m.slice(0,s).concat(m[s]))}},Curried:function(s,w,m){return m=m||[],function(d){var M=m.concat([d===void 0?null:d]);return w==1?s.apply(null,M):w==2?function(g){return s.apply(null,M.concat([g===void 0?null:g]))}:WebSharper.Runtime.Curried(s,w-1,M)}},Curried2:function(s){return function(w){return function(m){return s(w,m)}}},Curried3:function(s){return function(w){return function(m){return function(d){return s(w,m,d)}}}},UnionByType:function(s,w,m){for(var d,M=typeof w,g=0;g<s.length;g++)if(d=s[g],typeof d=="number"){if(Array.isArray(w)&&(d==0||w.length==d))return{$:g,$0:w}}else if(d==M)return{$:g,$0:w};if(!m)throw new Error("Type not expected for creating Choice value.")},MarkResizable:function(s){return Object.defineProperty(s,"resizable",{enumerable:!1,writable:!1,configurable:!1,value:!0}),s},MarkReadOnly:function(s){return Object.defineProperty(s,"readonly",{enumerable:!1,writable:!1,configurable:!1,value:!0}),s},ScriptBasePath:"./",ScriptPath:function(s,w){return this.ScriptBasePath+(this.ScriptSkipAssemblyDir?"":s+"/")+w},OnLoad:function(s){"load"in this||(this.load=[]),this.load.push(s)},Start:function(){function s(w){for(var m=0;m<w.length;m++)w[m]()}"load"in this&&(s(this.load),this.load=[])}}},h.WebSharper.Runtime.OnLoad(function(){h.WebSharper&&WebSharper.Activator&&WebSharper.Activator.Activate&&WebSharper.Activator.Activate()}),h.ignore=function(){},h.id=function(s){return s},h.fst=function(s){return s[0]},h.snd=function(s){return s[1]},h.trd=function(s){return s[2]},h.console||(h.console={count:ignore,dir:ignore,error:ignore,group:ignore,groupEnd:ignore,info:ignore,log:ignore,profile:ignore,profileEnd:ignore,time:ignore,timeEnd:ignore,trace:ignore,warn:ignore})})(self);(function(h,s){s=h.Element.prototype,s.matches||(s.matches=s.msMatchesSelector||function(w){for(var m=(this.document||this.ownerDocument).querySelectorAll(w),d=0;m[d]&&m[d]!==e;++d);return!!m[d]}),s.closest||(s.closest=function(w){for(var m=this;m&&m.nodeType==1;){if(m.matches(w))return m;m=m.parentNode}return null})})(self);(function(){for(var h=0,s=["webkit","moz"],w=0;w<s.length&&!window.requestAnimationFrame;++w)window.requestAnimationFrame=window[s[w]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[s[w]+"CancelAnimationFrame"]||window[s[w]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(m){var d=new Date().getTime(),M=Math.max(0,16-(d-h)),g=window.setTimeout(function(){m(d+M)},M);return h=d+M,g}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(m){clearTimeout(m)})})();(function(h){var s,w,m,d,M,g,le,z,Ct,ze,Ke,c,oe,nn,rn,De,Le,O,te,ft,Nt,p,_,Te,Vt,je,Z,We,ue,j,it,y,on,un,ve,Ae,K,Bt,an,It,Y,Ot,Tn,ht,Pe,ln,ie,cn,b,sn,Ht,fn,Qe,dt,Me,L,ce,be,I,qt,U,ne,Se,vt,Ne,ot,H,Ce,se,pe,At,bt,St,Et,Tt,pt,Je,v,W,ae,ut,Q,hn,at,dn,Ye,pn,xt,$t,fe,he,_e,Ie,de,zt,$n,mn,Kt,xe,jt,Qt,ee,Jt,Yt,Zt,Ze,Ft,mt,wn,$e,we,kt,gn,xn,Dt,Lt,yn,Pt,Xt,ge,wt,Ge,R,en,Ue,Mt,lt,Fe,B,gt,Oe,Xe,Cn,Nn,Be,yt,Gt,vn,An,C,me,Fn,Wt;s=h.GentleGame=h.GentleGame||{},w=s.Client=s.Client||{},m=h.StartupCode$GentleGame$Client=h.StartupCode$GentleGame$Client||{},d=h.WebSharper=h.WebSharper||{},M=d.Obj=d.Obj||{},g=d.UI=d.UI||{},le=g.Var$1=g.Var$1||{},z=s.GameModel=s.GameModel||{},Ct=h.GentleGame_Router=h.GentleGame_Router||{},ze=h.GentleGame_Templates=h.GentleGame_Templates||{},Ke=g.Router=g.Router||{},c=d.Arrays=d.Arrays||{},oe=d.Operators=d.Operators||{},nn=g.Templating=g.Templating||{},rn=nn.Runtime=nn.Runtime||{},De=rn.Server=rn.Server||{},Le=De.ProviderBuilder=De.ProviderBuilder||{},O=g.View=g.View||{},te=s.Pages=s.Pages||{},ft=g.Var=g.Var||{},Nt=g.ConcreteVar=g.ConcreteVar||{},p=g.Snap=g.Snap||{},_=h.StartupCode$GentleGame$GameModel=h.StartupCode$GentleGame$GameModel||{},Te=d.Sitelets=d.Sitelets||{},Vt=Te.RouterOperators=Te.RouterOperators||{},je=Te.RouterModule=Te.RouterModule||{},Z=Te.Route=Te.Route||{},We=De.TemplateInstance=De.TemplateInstance||{},ue=g.TemplateHole=g.TemplateHole||{},j=g.TemplateHoleModule=g.TemplateHoleModule||{},it=j.Elt=j.Elt||{},y=d.Unchecked=d.Unchecked||{},on=h.System=h.System||{},un=on.Guid=on.Guid||{},ve=z.GameState=z.GameState||{},Ae=z.Game=z.Game||{},K=d.List=d.List||{},Bt=g.HtmlModule=g.HtmlModule||{},an=Bt.attr=Bt.attr||{},It=d.Utils=d.Utils||{},Y=g.Doc=g.Doc||{},Ot=d.JavaScript=d.JavaScript||{},Tn=Ot.Pervasives=Ot.Pervasives||{},ht=g.Abbrev=g.Abbrev||{},Pe=ht.Fresh=ht.Fresh||{},ln=z.Player=z.Player||{},ie=K.T=K.T||{},cn=Ot.JS=Ot.JS||{},b=d.Seq=d.Seq||{},sn=Te.Router=Te.Router||{},Ht=Te.List=Te.List||{},fn=d.Option=d.Option||{},Qe=h.Node,dt=De.Handler=De.Handler||{},Me=j.Text=j.Text||{},L=d.Strings=d.Strings||{},ce=g.AttrProxy=g.AttrProxy||{},be=g.Array=g.Array||{},I=g.Docs=g.Docs||{},qt=d.Numeric=d.Numeric||{},U=d.Enumerator=d.Enumerator||{},ne=d.Collections=d.Collections||{},Se=ne.FSharpMap=ne.FSharpMap||{},vt=h.Object,Ne=U.T=U.T||{},ot=ne.Map=ne.Map||{},H=d.Concurrency=d.Concurrency||{},Ce=ne.Dictionary=ne.Dictionary||{},se=ne.HashSet=ne.HashSet||{},pe=De.TemplateInitializer=De.TemplateInitializer||{},At=j.VarStr=j.VarStr||{},bt=j.VarFloatUnchecked=j.VarFloatUnchecked||{},St=j.VarBool=j.VarBool||{},Et=j.VarDateTime=j.VarDateTime||{},Tt=j.VarFile=j.VarFile||{},pt=j.VarDomElement=j.VarDomElement||{},Je=g.Client=g.Client||{},v=Je.Templates=Je.Templates||{},W=g.Attrs=g.Attrs||{},ae=g.DomUtility=g.DomUtility||{},ut=h.StartupCode$WebSharper_UI$Abbrev=h.StartupCode$WebSharper_UI$Abbrev||{},Q=ne.BalancedTree=ne.BalancedTree||{},hn=Q.Tree=Q.Tree||{},at=ne.Pair=ne.Pair||{},dn=ne.DictionaryUtil=ne.DictionaryUtil||{},Ye=g.DocElemNode=g.DocElemNode||{},pn=ne.MapUtil=ne.MapUtil||{},xt=H.Scheduler=H.Scheduler||{},$t=Te.PathUtil=Te.PathUtil||{},fe=h.StartupCode$WebSharper_UI$Templates=h.StartupCode$WebSharper_UI$Templates||{},he=v.Prepare=v.Prepare||{},_e=d.Slice=d.Slice||{},Ie=g.Elt=g.Elt||{},de=g.An=g.An||{},zt=Je.Settings=Je.Settings||{},$n=ht.Mailbox=ht.Mailbox||{},mn=Je.Attrs=Je.Attrs||{},Kt=mn.Dyn=mn.Dyn||{},xe=h.StartupCode$WebSharper_Main$Concurrency=h.StartupCode$WebSharper_Main$Concurrency||{},jt=j.Attribute=j.Attribute||{},Qt=j.Event=j.Event||{},ee=g.AttrModule=g.AttrModule||{},Jt=j.EventQ=j.EventQ||{},Yt=j.AfterRender=j.AfterRender||{},Zt=j.AfterRenderQ=j.AfterRenderQ||{},Ze=g.Updates=g.Updates||{},Ft=ne.ValueCollection=ne.ValueCollection||{},mt=Je.Docs=Je.Docs||{},wn=mt.RunState=mt.RunState||{},$e=mt.NodeSet=mt.NodeSet||{},we=g.Anims=g.Anims||{},kt=h.StartupCode$WebSharper_UI$Doc_Proxy=h.StartupCode$WebSharper_UI$Doc_Proxy||{},gn=d.Queue=d.Queue||{},xn=h.Element,Dt=ne.KeyCollection=ne.KeyCollection||{},Lt=ne.HashSetUtil=ne.HashSetUtil||{},yn=H.CT=H.CT||{},Pt=d.CancellationTokenSource=d.CancellationTokenSource||{},Xt=H.AsyncBody=H.AsyncBody||{},ge=h.StartupCode$WebSharper_UI$DomUtility=h.StartupCode$WebSharper_UI$DomUtility||{},wt=h.StartupCode$WebSharper_UI$Animation=h.StartupCode$WebSharper_UI$Animation||{},Ge=g.AppendList=g.AppendList||{},R=h.StartupCode$WebSharper_UI$Attr_Client=h.StartupCode$WebSharper_UI$Attr_Client||{},en=h.Error,Ue=d.KeyNotFoundException=d.KeyNotFoundException||{},Mt=g.DynamicAttrNode=g.DynamicAttrNode||{},lt=g.Easing=g.Easing||{},Fe=ht.HashSet=ht.HashSet||{},B=g.BindVar=g.BindVar||{},gt=g.String=g.String||{},Oe=g.CheckedInput=g.CheckedInput||{},Xe=mt.DomNodes=mt.DomNodes||{},Cn=d.Char=d.Char||{},Nn=d.DateUtil=d.DateUtil||{},Be=d.OperationCanceledException=d.OperationCanceledException||{},yt=d.Lazy=d.Lazy||{},Gt=h.StartupCode$WebSharper_UI$AppendList=h.StartupCode$WebSharper_UI$AppendList||{},vn=d.LazyExtensionsProxy=d.LazyExtensionsProxy||{},An=vn.LazyRecord=vn.LazyRecord||{},C=d&&d.Runtime,me=h.console,Fn=h.Math,Wt=h.Date,w.Main=function(){return m.$cctor(),m.Main},w.router=function(){return m.$cctor(),m.router},w.currentPage=function(){return m.$cctor(),m.currentPage},m.$cctor=function(){var t,n,r,i;m.$cctor=h.ignore,m.gameState=le.Create$1(z.initialGame()),m.router=Ct.r(),m.currentPage=Ke.InstallHash({$:0},w.router()),m.Main=(t=(n=Y.EmbedView(O.Map(function(o){return o.$==1?te.GamePageIntro():o.$==2?te.GamePageStart():o.$==3||o.$==4||o.$==5||o.$==6||o.$==7||o.$==8||o.$==9||o.$==10||o.$==11||o.$==12||o.$==13||o.$==14?te.GamePageLocation():te.Homepage()},w.currentPage().get_View())),r=new Le.New$1,r.h.push(new it.New("pagecontent",n)),r),i=dt.CompleteHoles(t.k,t.h,[]),t.i=new We.New(i[1],v.RunFullDocTemplate(i[0])))},M=d.Obj=C.Class({Equals:function(t){return this===t},GetHashCode:function(){return-1}},null,M),M.New=C.Ctor(function(){},M),le=g.Var$1=C.Class({},M,le),le.Create$1=function(t){return new Nt.New(!1,p.New({$:2,$0:t,$1:[]}),t)},z.initialGame=function(){return _.$cctor(),_.initialGame},z.forestEntrance=function(){return _.$cctor(),_.forestEntrance},z.initialPlayer=function(){return _.$cctor(),_.initialPlayer},z.initialState=function(){return _.$cctor(),_.initialState},z.updateGameState=function(t,n){return n=="ForestEntrance"?Ae.New(t.Player,z.forestEntrance()):n=="DeepForest"?Ae.New(t.Player,z.deepForest()):n=="HiddenTrail"?Ae.New(t.Player,z.hiddenTrail()):n=="BabblingBrook"?Ae.New(t.Player,z.babblingBrook()):n=="RuneStone"?Ae.New(t.Player,z.runeStone()):n=="CaveEntrance"?Ae.New(t.Player,z.caveEntrance()):n=="AncientCave"?Ae.New(t.Player,z.ancientCave()):n=="DarkPath"?Ae.New(t.Player,z.darkPath()):n=="LightPath"?Ae.New(t.Player,z.lightPath()):n=="ChamberOfAmulet"?Ae.New(t.Player,z.chamberOfAmulet()):n=="FightBeast"?Ae.New(t.Player,z.fightBeast()):n=="Map"?Ae.New(t.Player,z.map()):t},z.deepForest=function(){return _.$cctor(),_.deepForest},z.hiddenTrail=function(){return _.$cctor(),_.hiddenTrail},z.babblingBrook=function(){return _.$cctor(),_.babblingBrook},z.runeStone=function(){return _.$cctor(),_.runeStone},z.caveEntrance=function(){return _.$cctor(),_.caveEntrance},z.ancientCave=function(){return _.$cctor(),_.ancientCave},z.darkPath=function(){return _.$cctor(),_.darkPath},z.lightPath=function(){return _.$cctor(),_.lightPath},z.chamberOfAmulet=function(){return _.$cctor(),_.chamberOfAmulet},z.fightBeast=function(){return _.$cctor(),_.fightBeast},z.map=function(){return _.$cctor(),_.map},Ct.r=function(){return Vt.JSUnion(void 0,[[null,[[null,[]]],[]],[null,[[null,["gamePage"]]],[]],[null,[[null,["gamePage","start"]]],[]],[null,[[null,["gamePage","start","ForestEntrance"]]],[]],[null,[[null,["gamePage","start","Map"]]],[]],[null,[[null,["gamePage","start","DeepForest"]]],[]],[null,[[null,["gamePage","start","HiddenTrail"]]],[]],[null,[[null,["gamePage","start","BabblingBrook"]]],[]],[null,[[null,["gamePage","start","RuneStone"]]],[]],[null,[[null,["gamePage","start","CaveEntrance"]]],[]],[null,[[null,["gamePage","start","AncientCave"]]],[]],[null,[[null,["gamePage","start","DarkPath"]]],[]],[null,[[null,["gamePage","start","LightPath"]]],[]],[null,[[null,["gamePage","start","FightBeast"]]],[]],[null,[[null,["gamePage","start","ChamberOfAmulet"]]],[]]])},ze.gamepageintro=function(t){return v.LoadLocalTemplates("index"),t?v.NamedTemplate("index",{$:1,$0:"gamepageintro"},t):void 0},ze.gamepagestart=function(t){return v.LoadLocalTemplates("index"),t?v.NamedTemplate("index",{$:1,$0:"gamepagestart"},t):void 0},ze.gamepagelocation=function(t){return v.LoadLocalTemplates("index"),t?v.NamedTemplate("index",{$:1,$0:"gamepagelocation"},t):void 0},ze.homepage=function(t){return v.LoadLocalTemplates("index"),t?v.NamedTemplate("index",{$:1,$0:"homepage"},t):void 0},Ke.InstallHash=function(t,n){var r;return r=le.Create$1(void 0),Ke.InstallHashInto(r,t,n),r},Ke.InstallHashInto=function(t,n,r){function i(a){return je.Parse(r,Z.FromHash(a,{$:1,$0:!0}))}function o(){return Ke.getCurrentHash(i,n)}function u(a){y.Equals(t.Get(),a)||t.Set(a)}u(o()),self.addEventListener("popstate",function(){return u(o())},!1),self.addEventListener("hashchange",function(){return u(o())},!1),self.document.body.addEventListener("click",function(a){var l,f,$;return l=(f=Ke.findLinkHref(a.target),f==null?null:($=f.$0,L.StartsWith($,"#")?i($):null)),l==null?null:(u(l.$0),a.preventDefault())},!1),O.Sink(function(a){var l;y.Equals(a,o())||(l=je.HashLink(r,a),self.history.pushState(null,null,l))},t.get_View())},Ke.getCurrentHash=function(t,n){var r,i;return r=self.location.hash,i=t(r),i==null?(function(o){return function(u){return o("Failed to parse route: "+It.toSafe(u))}}(function(o){me.log(o)})(r),n):i.$0},Ke.findLinkHref=function(t){for(;;){if(t.tagName=="A")return fn.ofObj(t.getAttribute("href"));if(t===self.document.body)return null;t=t.parentNode}},c.get=function(t,n){return c.checkBounds(t,n),t[n]},c.checkBounds=function(t,n){(n<0||n>=t.length)&&oe.FailWith("Index was outside the bounds of the array.")},c.length=function(t){return t.dims===2?t.length*t.length:t.length},c.set=function(t,n,r){c.checkBounds(t,n),t[n]=r},oe.FailWith=function(t){throw new en(t)},oe.KeyValue=function(t){return[t.K,t.V]},oe.range=function(t,n){var r;return r=1+n-t,r<=0?[]:b.init(r,function(i){return i+t})},Le=De.ProviderBuilder=C.Class({},M,Le),Le.New$1=C.Ctor(function(){var t;M.New.call(this),this.i=null,this.k=(t=un.NewGuid(),h.String(t)),this.h=C.MarkResizable([]),C.SetOptional(this,"s",null)},Le),O=g.View=C.Class({},null,O),te.GamePageIntro=function(){var t,n,r,i;return(t=(n=new Le.New$1,n.h.push(new Me.New("togamepagestart","/#/gamePage/start")),n),r=dt.CompleteHoles(t.k,t.h,[]),i=new We.New(r[1],ze.gamepageintro(r[0])),t.i=i,i).get_Doc()},te.GamePageStart=function(){var t,n,r,i;return(t=(n=new Le.New$1,n.h.push(new Me.New("togamepagelocation","/#/gamePage/start/ForestEntrance")),n),r=dt.CompleteHoles(t.k,t.h,[]),i=new We.New(r[1],ze.gamepagestart(r[0])),t.i=i,i).get_Doc()},te.GamePageLocation=function(){var t,n,r,i,o,u,a,l,f,$,A;function P(S,x){return Y.Element("a",[ce.Create("href","/#/gamePage/start/"+It.toSafe(x))],[Y.Element("button",[ce.Create("class","continue-button"),ce.HandlerImpl("click",function(){return function(){return te.updateGame(x)}})],[Y.TextNode(S)])])}return(t=(n=Y.Concat(K.map(function(S){return P(S[0],S[1])},te.gameState().Get().State.Options)),r=(i=L.Replace(te.gameState().Get().State.Location," ",""),o=(u=te.gameState().Get().State.Description,a=(l=te.gameState().Get().State.Location,f=new Le.New$1,f.h.push(new Me.New("location",l)),f),a.h.push(new Me.New("description",u)),a),o.h.push(new Me.New("gameimage",i)),o),r.h.push(new it.New("continuebuttonsection",n)),r),$=dt.CompleteHoles(t.k,t.h,[]),A=new We.New($[1],ze.gamepagelocation($[0])),t.i=A,A).get_Doc()},te.Homepage=function(){var t,n,r,i;return(t=(n=new Le.New$1,n.h.push(new Me.New("togamepage","/#/gamePage")),n),r=dt.CompleteHoles(t.k,t.h,[]),i=new We.New(r[1],ze.homepage(r[0])),t.i=i,i).get_Doc()},te.gameState=function(){return m.$cctor(),m.gameState},te.updateGame=function(t){te.gameState().Set(z.updateGameState(te.gameState().Get(),t))},ft=g.Var=C.Class({},M,ft),ft.New=C.Ctor(function(){M.New.call(this)},ft),Nt=g.ConcreteVar=C.Class({get_View:function(){return this.view},Get:function(){return this.current},Set:function(t){this.isConst?function(n){return n("WebSharper.UI: invalid attempt to change value of a Var after calling SetFinal")}(function(n){me.log(n)}):(p.Obsolete(this.snap),this.current=t,this.snap=p.New({$:2,$0:t,$1:[]}))},SetFinal:function(t){this.isConst?function(n){return n("WebSharper.UI: invalid attempt to change value of a Var after calling SetFinal")}(function(n){me.log(n)}):(p.Obsolete(this.snap),this.isConst=!0,this.current=t,this.snap=p.New({$:0,$0:t}))},UpdateMaybe:function(t){var n;n=t(this.Get()),n!=null&&n.$==1&&this.Set(n.$0)}},ft,Nt),Nt.New=C.Ctor(function(t,n,r){var i;i=this,ft.New.call(this),this.isConst=t,this.current=r,this.snap=n,this.view=function(){return i.snap},this.id=Pe.Int()},Nt),p.Map=function(t,n){var r,i;return r=n.s,r!=null&&r.$==0?p.New({$:0,$0:t(r.$0)}):(i=p.New({$:3,$0:[],$1:[]}),p.When(n,function(o){p.MarkDone(i,n,t(o))},i),i)},p.WhenRun=function(t,n,r){var i;i=t.s,i==null?r():i!=null&&i.$==2?(i.$1.push(r),n(i.$0)):i!=null&&i.$==3?(i.$0.push(n),i.$1.push(r)):n(i.$0)},p.WhenObsoleteRun=function(t,n){var r;r=t.s,r==null?n():(r!=null&&r.$==2||r!=null&&r.$==3)&&r.$1.push(n)},p.When=function(t,n,r){var i;i=t.s,i==null?p.Obsolete(r):i!=null&&i.$==2?(p.EnqueueSafe(i.$1,r),n(i.$0)):i!=null&&i.$==3?(i.$0.push(n),p.EnqueueSafe(i.$1,r)):n(i.$0)},p.MarkDone=function(t,n,r){var i;i=n.s,i!=null&&i.$==0?p.MarkForever(t,r):p.MarkReady(t,r)},p.EnqueueSafe=function(t,n){var r,i,o,u;if(t.push(n),t.length%20===0)for(r=t.slice(0),gn.Clear(t),i=0,o=c.length(r)-1;i<=o;i++)u=c.get(r,i),typeof u=="object"?function(a){a.s&&t.push(a)}(u):function(a){t.push(a)}(u)},p.MarkForever=function(t,n){var r,i,o,u;if(r=t.s,r!=null&&r.$==3)for(t.s={$:0,$0:n},i=r.$0,o=0,u=c.length(i)-1;o<=u;o++)c.get(i,o)(n)},p.MarkReady=function(t,n){var r,i,o,u;if(r=t.s,r!=null&&r.$==3)for(t.s={$:2,$0:n,$1:r.$1},i=r.$0,o=0,u=c.length(i)-1;o<=u;o++)c.get(i,o)(n)},p.Map2Unit=function(t,n){var r,i,o;function u(){var a,l,f;a=o.s,!(a!=null&&a.$==0||a!=null&&a.$==2)&&(l=p.ValueAndForever(t),f=p.ValueAndForever(n),l!=null&&l.$==1&&f!=null&&f.$==1&&(l.$0[1]&&f.$0[1]?p.MarkForever(o,null):p.MarkReady(o,null)))}return r=t.s,i=n.s,r!=null&&r.$==0?i!=null&&i.$==0?p.New({$:0,$0:null}):n:i!=null&&i.$==0?t:(o=p.New({$:3,$0:[],$1:[]}),p.When(t,u,o),p.When(n,u,o),o)},p.Join=function(t){var n;return n=p.New({$:3,$0:[],$1:[]}),p.When(t,function(r){var i;i=r(),p.When(i,function(o){var u,a;u=i.s,u!=null&&u.$==0&&(a=t.s,a!=null&&a.$==0)?p.MarkForever(n,o):p.MarkReady(n,o)},n)},n),n},p.ValueAndForever=function(t){var n;return n=t.s,n!=null&&n.$==0?{$:1,$0:[n.$0,!0]}:n!=null&&n.$==2?{$:1,$0:[n.$0,!1]}:null},p.Map3=function(t,n,r,i){var o,u,a,l;function f($){var A,P,S,x;A=l.s,!(A!=null&&A.$==0||A!=null&&A.$==2)&&(P=p.ValueAndForever(n),S=p.ValueAndForever(r),x=p.ValueAndForever(i),P!=null&&P.$==1&&S!=null&&S.$==1&&x!=null&&x.$==1&&(P.$0[1]&&S.$0[1]&&x.$0[1]?p.MarkForever(l,t(P.$0[0],S.$0[0],x.$0[0])):p.MarkReady(l,t(P.$0[0],S.$0[0],x.$0[0]))))}return o=n.s,u=r.s,a=i.s,o!=null&&o.$==0?u!=null&&u.$==0?a!=null&&a.$==0?p.New({$:0,$0:t(o.$0,u.$0,a.$0)}):p.Map3Opt1(t,o.$0,u.$0,i):a!=null&&a.$==0?p.Map3Opt2(t,o.$0,a.$0,r):p.Map3Opt3(t,o.$0,r,i):u!=null&&u.$==0?a!=null&&a.$==0?p.Map3Opt4(t,u.$0,a.$0,n):p.Map3Opt5(t,u.$0,n,i):a!=null&&a.$==0?p.Map3Opt6(t,a.$0,n,r):(l=p.New({$:3,$0:[],$1:[]}),p.When(n,f,l),p.When(r,f,l),p.When(i,f,l),l)},p.Sequence=function(t){var n,r,i;function o(u){var a;i[0]===0?(a=c.map(function(l){var f;return f=l.s,f!=null&&f.$==0||f!=null&&f.$==2?f.$0:oe.FailWith("value not found by View.Sequence")},n),c.forall(function(l){var f;return f=l.s,f!=null&&f.$==0},n)?p.MarkForever(r,a):p.MarkReady(r,a)):i[0]=i[0]-1}return n=c.ofSeq(t),n.length==0?p.New({$:0,$0:[]}):(r=p.New({$:3,$0:[],$1:[]}),i=[c.length(n)-1],c.iter(function(u){p.When(u,o,r)},n),r)},p.Map2=function(t,n,r){var i,o,u;function a(l){var f,$,A;f=u.s,!(f!=null&&f.$==0||f!=null&&f.$==2)&&($=p.ValueAndForever(n),A=p.ValueAndForever(r),$!=null&&$.$==1&&A!=null&&A.$==1&&($.$0[1]&&A.$0[1]?p.MarkForever(u,t($.$0[0],A.$0[0])):p.MarkReady(u,t($.$0[0],A.$0[0]))))}return i=n.s,o=r.s,i!=null&&i.$==0?o!=null&&o.$==0?p.New({$:0,$0:t(i.$0,o.$0)}):p.Map2Opt1(t,i.$0,r):o!=null&&o.$==0?p.Map2Opt2(t,o.$0,n):(u=p.New({$:3,$0:[],$1:[]}),p.When(n,a,u),p.When(r,a,u),u)},p.Copy=function(t){var n,r,i;return n=t.s,n==null?t:n!=null&&n.$==2?(r=p.New({$:2,$0:n.$0,$1:[]}),p.WhenObsolete(t,r),r):n!=null&&n.$==3?(i=p.New({$:3,$0:[],$1:[]}),p.When(t,function(o){p.MarkDone(i,t,o)},i),i):t},p.Map3Opt1=function(t,n,r,i){return p.Map(function(o){return t(n,r,o)},i)},p.Map3Opt2=function(t,n,r,i){return p.Map(function(o){return t(n,o,r)},i)},p.Map3Opt3=function(t,n,r,i){return p.Map2(function(o,u){return t(n,o,u)},r,i)},p.Map3Opt4=function(t,n,r,i){return p.Map(function(o){return t(o,n,r)},i)},p.Map3Opt5=function(t,n,r,i){return p.Map2(function(o,u){return t(o,n,u)},r,i)},p.Map3Opt6=function(t,n,r,i){return p.Map2(function(o,u){return t(o,u,n)},r,i)},p.Map2Opt1=function(t,n,r){return p.Map(function(i){return t(n,i)},r)},p.Map2Opt2=function(t,n,r){return p.Map(function(i){return t(i,n)},r)},p.WhenObsolete=function(t,n){var r;r=t.s,r==null?p.Obsolete(n):(r!=null&&r.$==2||r!=null&&r.$==3)&&p.EnqueueSafe(r.$1,n)},_.$cctor=function(){_.$cctor=h.ignore,_.initialPlayer=ln.New("Adventurer",100,ie.Empty),_.forestEntrance=ve.New("Forest Entrance","You stand at the entrance of the Forest of Whispers. The path ahead is obscured by thick foliage. You can feel an eerie presence around you.",K.ofArray([["Go North","DeepForest"],["Check Map","Map"]])),_.deepForest=ve.New("Deep Forest","You venture deeper into the forest. The trees are tall and ancient, their branches intertwining to form a natural canopy. You notice a faint trail leading to the east and hear water flowing to the west.",K.ofArray([["Follow the Trail East","HiddenTrail"],["Head West towards the Sound of Water","BabblingBrook"],["Return to the Forest Entrance","ForestEntrance"]])),_.hiddenTrail=ve.New("Hidden Trail","You follow the trail east and come across a hidden clearing. In the center of the clearing stands a large, moss-covered stone with strange runes etched into it.",K.ofArray([["Inspect the Stone","RuneStone"],["Return to the Deep Forest","DeepForest"]])),_.babblingBrook=ve.New("Babbling Brook","You follow the sound of water to a small brook. The water is crystal clear, and you can see fish swimming in it. On the other side of the brook, you notice a cave entrance.",K.ofArray([["Cross the Brook to Enter the Cave","CaveEntrance"],["Return to the Deep Forest","DeepForest"]])),_.runeStone=ve.New("Rune Stone","Upon closer inspection, the runes on the stone begin to glow faintly. You feel a surge of energy, and the ground beneath you trembles. A hidden compartment opens, revealing a piece of an ancient map.",K.ofArray([["Take the Map Piece","DeepForest"],["Return to the Hidden Trail","HiddenTrail"]])),_.caveEntrance=ve.New("Cave Entrance","You carefully cross the brook and stand at the entrance of the cave. It's dark and foreboding, with a cold breeze flowing out. You can just make out a faint light deeper inside.",K.ofArray([["Enter the Cave","AncientCave"],["Return to the Babbling Brook","BabblingBrook"]])),_.ancientCave=ve.New("Ancient Cave","Inside the cave, you find ancient carvings on the walls depicting the story of the amulet. The cave branches into two paths: one leading deeper into darkness, the other towards a shimmering light.",K.ofArray([["Follow the Path into Darkness","DarkPath"],["Follow the Path to the Light","LightPath"]])),_.lightPath=ve.New("Light Path","You follow the light path, and it becomes increasingly narrow and treacherous. Suddenly, you encounter a fearsome beast guarding a treasure chest. Now you have to fight with him.",K.ofArray([["Fight the Beast","FightBeast"]])),_.darkPath=ve.New("Dark Path","You follow the dark path and find a hidden chamber filled with ancient artifacts. In the center, on a pedestal, lies the Lost Amulet, glowing with a mystical light.",K.ofArray([["Take the Amulet","ChamberOfAmulet"],["Return to the Cave Entrance","CaveEntrance"]])),_.chamberOfAmulet=ve.New("Chamber of the Amulet","As you take the amulet, you feel a surge of power coursing through you. You have completed your quest and can now return to the Forest Entrance with the amulet.",K.ofArray([["Return to the Forest Entrance","ForestEntrance"]])),_.fightBeast=ve.New("Fight with Beast","You engage in a fierce battle with the beast. Despite your best efforts, the beast proves too strong, and you are defeated.",K.ofArray([["Return to the Forest Entrance","ForestEntrance"]])),_.map=ve.New("Map","You check the map. It shows a rough layout of the forest with markings for trails and notable locations.",K.ofArray([["Return to the Forest Entrance","ForestEntrance"]])),_.initialState=ve.New(z.forestEntrance().Location,z.forestEntrance().Description,z.forestEntrance().Options),_.initialGame=Ae.New(z.initialPlayer(),z.initialState())},Vt.JSUnion=function(t,n){var r;function i(l){var f;function $(A){return A!=null&&A.$==1&&y.Equals(l,A.$0)}return f=b.tryFindIndex(function(A){return $(A[0])},n),f!=null&&f.$==1?f.$0:l.$}function o(l,f){return c.init(c.length(c.get(n,l)[2]),function($){return f["$"+h.String($)]})}function u(l,f){var $,A,P;return $=t==null?{}:new t,A=c.get(n,l),P=A[0],P!=null&&P.$==1?A[0].$0:($.$=l,b.iteri(function(S,x){$["$"+h.String(S)]=x},f),$)}function a(l,f){var $;function A(P,S){return[l,P,S,$]}return $=f[2],b.map(function(P){return A(P[0],P[1])},f[1])}return r=c.ofSeq(b.collect(function(l){return a(l[0],l[1])},b.indexed(n))),sn.New$1(function(l){function f($,A,P,S){var x,E,T;function V(N){return function(k){return function(D){var F;function G(q,re){return V(F)(q)(new ie({$:1,$0:re,$1:D}))}return N.$==1?(F=N.$1,b.collect(function(q){return G(q[0],q[1])},N.$0.Parse(k))):[[k,u($,c.ofList(K.rev(D)))]]}}}return Vt.isCorrectMethod(A,l.Method)?(x=Ht.startsWith(K.ofArray(P),l.Segments),x==null?[]:(E=x.$0,T=K.ofArray(S),T.$==0?[[Z.New(E,l.QueryArgs,l.FormData,l.Method,l.Body),u($,[])]]:V(T)(Z.New(E,l.QueryArgs,l.FormData,l.Method,l.Body))(ie.Empty))):[]}return b.collect(function($){return f($[0],$[1],$[2],$[3])},r)},function(l){var f,$,A,P,S,x;function E(T,V){return V.Write(T)}return f=i(l),$=c.get(n,f),A=$[2],P=c.get($[1],0),S=[Z.Segment(K.ofArray(P[1]),P[0])],A.length==0?{$:1,$0:S}:(x=C.Curried3(c.map2)(E)(o(f,l))(A),c.forall(function(T){return T!=null},x)?{$:1,$0:b.append(S,b.collect(function(T){return T.$0},x))}:null)})},Vt.isCorrectMethod=function(t,n){return n!=null&&n.$==1?t!=null&&t.$==1?y.Equals(n.$0,t.$0):!0:!(t!=null&&t.$==1)},je.Parse=function(t,n){function r(i,o){return i.Segments.$==0?{$:1,$0:o}:null}return b.tryPick(function(i){return r(i[0],i[1])},t.Parse(n))},je.HashLink=function(t,n){return"#"+je.Link(t,n)},je.Link=function(t,n){var r;return r=je.Write(t,n),r==null?"":r.$0.ToLink()},je.Write=function(t,n){var r;return r=t.Write(n),r==null?null:{$:1,$0:Z.Combine(r.$0)}},Z=Te.Route=C.Class({ToLink:function(){return $t.WriteLink(this.Segments,this.QueryArgs)}},null,Z),Z.FromHash=function(t,n){var r,i;return r=t.indexOf("#"),r===-1?Z.get_Empty():(i=t.substring(r+1),n!=null&&n.$0?i==""||i=="/"?Z.get_Empty():L.StartsWith(i,"/")?Z.FromUrl(i.substring(1),{$:1,$0:!0}):Z.Segment$2(i):Z.FromUrl(t.substring(r),{$:1,$0:!1}))},Z.Segment=function(t,n){var r;return r=Z.get_Empty(),Z.New(t,r.QueryArgs,r.FormData,n,r.Body)},Z.get_Empty=function(){return Z.New(ie.Empty,new Se.New([]),new Se.New([]),null,{$:1,$0:null})},Z.FromUrl=function(t,n){var r,i,o;return r=(i=t.indexOf("?"),i===-1?[t,new Se.New([])]:[L.Substring(t,0,i),Z.ParseQuery(t.substring(i+1))]),o=Z.get_Empty(),Z.New(K.ofArray(L.SplitChars(r[0],["/"],n!=null&&n.$0?0:1)),r[1],o.FormData,o.Method,o.Body)},Z.Segment$2=function(t){var n;return n=Z.get_Empty(),Z.New(K.ofArray([t]),n.QueryArgs,n.FormData,n.Method,n.Body)},Z.ParseQuery=function(t){return ot.OfArray(c.ofSeq(c.choose(function(n){var r,i;return r=L.SplitChars(n,["="],0),!y.Equals(r,null)&&r.length===2?(i=c.get(r,1),{$:1,$0:[c.get(r,0),i]}):(function(o){return function(u){return o("wrong format for query argument: "+It.toSafe(u))}}(function(o){me.log(o)})(n),null)},L.SplitChars(t,["&"],0))))},Z.Combine=function(t){var n,r,i,o,u,a,l;return n=c.ofSeq(t),r=c.length(n),r===0?Z.get_Empty():r===1?c.get(n,0):(i=null,o=null,u=[],a=new Se.New([]),l=new Se.New([]),c.iter(function(f){var $,A;$=f.Method,$!=null&&$.$==1&&(i=$),A=f.Body,A==null||(o=A),a=ot.FoldBack(function(P,S,x){return x.Add$1(P,S)},a,f.QueryArgs),l=ot.FoldBack(function(P,S,x){return x.Add$1(P,S)},l,f.FormData),K.iter(function(P){u.push(P)},f.Segments)},n),Z.New(K.ofSeq(u),a,l,i,o))},Z.New=function(t,n,r,i,o){return new Z({Segments:t,QueryArgs:n,FormData:r,Method:i,Body:o})},We=De.TemplateInstance=C.Class({get_Doc:function(){return this.doc}},M,We),We.New=C.Ctor(function(t,n){M.New.call(this),this.doc=n,this.allVars=t.$==0?t.$0:oe.FailWith("Should not happen"),this.anchorRoot=null},We),ue=g.TemplateHole=C.Class({ForTextView:function(){return me.warn("Content hole filled with attribute data",this.get_Name()),null},AddAttribute:function(t,n){me.warn("Var hole filled with non-Var data",this.get_Name())},get_AsChoiceView:function(){return me.warn("Attribute value hole filled with non-text data",this.get_Name()),{$:0,$0:""}}},M,ue),ue.New=C.Ctor(function(){M.New.call(this)},ue),it=j.Elt=C.Class({get_Name:function(){return this.name},get_Value:function(){return this.fillWith}},ue,it),it.New=C.Ctor(function(t,n){ue.New.call(this),this.name=t,this.fillWith=n},it),y.Equals=function(t,n){var r,i;if(t===n)return!0;if(r=typeof t,r=="object"){if(t==null||n===null||n===void 0||!y.Equals(typeof n,"object"))return!1;if("Equals"in t)return t.Equals(n);if("Equals"in n)return!1;if(t instanceof h.Array&&n instanceof h.Array)return y.arrayEquals(t,n);if(t instanceof h.Date&&n instanceof h.Date)return y.dateEquals(t,n);i=[!0];for(var o in t)if(function(a){return i[0]=!t.hasOwnProperty(a)||n.hasOwnProperty(a)&&y.Equals(t[a],n[a]),!i[0]}(o))break;if(i[0]){for(var u in n)if(function(a){return i[0]=!n.hasOwnProperty(a)||t.hasOwnProperty(a),!i[0]}(u))break}return i[0]}else return r=="function"&&("$Func"in t?t.$Func===n.$Func&&t.$Target===n.$Target:"$Invokes"in t&&"$Invokes"in n&&y.arrayEquals(t.$Invokes,n.$Invokes))},y.arrayEquals=function(t,n){var r,i;if(c.length(t)===c.length(n)){for(r=!0,i=0;r&&i<c.length(t);)y.Equals(c.get(t,i),c.get(n,i))||(r=!1),i=i+1;return r}else return!1},y.dateEquals=function(t,n){return t.getTime()===n.getTime()},y.Hash=function(t){var n;return n=typeof t,n=="function"?0:n=="boolean"?t?1:0:n=="number"?t:n=="string"?y.hashString(t):n=="object"?t==null?0:t instanceof h.Array?y.hashArray(t):y.hashObject(t):0},y.hashString=function(t){var n,r,i;if(t===null)return 0;for(n=5381,r=0,i=t.length-1;r<=i;r++)n=y.hashMix(n,t[r].charCodeAt());return n},y.hashArray=function(t){var n,r,i;for(n=-34948909,r=0,i=c.length(t)-1;r<=i;r++)n=y.hashMix(n,y.Hash(c.get(t,r)));return n},y.hashObject=function(t){var n;if("GetHashCode"in t)return t.GetHashCode();n=[0];for(var r in t)(function(i){return n[0]=y.hashMix(y.hashMix(n[0],y.hashString(i)),y.Hash(t[i])),!1})(r);return n[0]},y.hashMix=function(t,n){return(t<<5)+t+n},y.Compare=function(t,n){var r,i,o;if(t===n)return 0;switch(r=typeof t,r=="function"?1:r=="boolean"||r=="number"||r=="string"?2:r=="object"?3:0){case 0:return typeof n>"u"?0:-1;case 1:return oe.FailWith("Cannot compare function values.");case 2:return t<n?-1:1;case 3:if(t===null)i=-1;else if(n===null)i=1;else if("CompareTo"in t)i=t.CompareTo(n);else if("CompareTo0"in t)i=t.CompareTo0(n);else if(t instanceof h.Array&&n instanceof h.Array)i=y.compareArrays(t,n);else if(t instanceof h.Date&&n instanceof h.Date)i=y.compareDates(t,n);else{o=[0];for(var u in t)if(function(l){return t.hasOwnProperty(l)?n.hasOwnProperty(l)?(o[0]=y.Compare(t[l],n[l]),o[0]!==0):(o[0]=1,!0):!1}(u))break;if(o[0]===0){for(var a in n)if(function(l){return n.hasOwnProperty(l)?!t.hasOwnProperty(l)&&(o[0]=-1,!0):!1}(a))break}i=o[0]}return i}},y.compareArrays=function(t,n){var r,i;if(c.length(t)<c.length(n))return-1;if(c.length(t)>c.length(n))return 1;for(r=0,i=0;r===0&&i<c.length(t);)r=y.Compare(c.get(t,i),c.get(n,i)),i=i+1;return r},y.compareDates=function(t,n){return y.Compare(t.getTime(),n.getTime())},un.NewGuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(new h.RegExp("[xy]","g"),function(t){var n,r;return n=Fn.random()*16|0,r=t=="x"?n:n&3|8,r.toString(16)})},O.Map=function(t,n){return O.CreateLazy(function(){return p.Map(t,n())})},O.Sink=function(t,n){function r(){p.WhenRun(n(),t,function(){H.scheduler().Fork(r)})}H.scheduler().Fork(r)},O.CreateLazy=function(t){var n;return n={c:null,o:t},function(){var r,i;return r=n.c,r===null&&(r=n.o(),n.c=r,i=r.s,i!=null&&i.$==0?n.o=null:p.WhenObsoleteRun(r,function(){n.c=null})),r}},O.Bind=function(t,n){return O.Join(O.Map(t,n))},O.Const=function(t){var n;return n=p.New({$:0,$0:t}),function(){return n}},O.Map2Unit=function(t,n){return O.CreateLazy(function(){return p.Map2Unit(t(),n())})},O.Join=function(t){return O.CreateLazy(function(){return p.Join(t())})},O.Map3=function(t,n,r,i){return O.CreateLazy(function(){return p.Map3(t,n(),r(),i())})},O.Sequence=function(t){return O.CreateLazy(function(){return p.Sequence(b.map(function(n){return n()},t))})},O.Map2=function(t,n,r){return O.CreateLazy(function(){return p.Map2(t,n(),r())})},ve.New=function(t,n,r){return{Location:t,Description:n,Options:r}},Ae.New=function(t,n){return{Player:t,State:n}},K.map=function(t,n){var r,i,o,u,a;if(n.$==0)return n;for(u=new ie({$:1}),r=u,i=n,o=!0;o;)r.$0=t(i.$0),i=i.$1,i.$==0?o=!1:r=(a=new ie({$:1}),r.$1=a,a);return r.$1=ie.Empty,u},K.ofArray=function(t){var n,r,i;for(n=ie.Empty,r=c.length(t)-1,i=0;r>=i;r--)n=new ie({$:1,$0:c.get(t,r),$1:n});return n},K.rev=function(t){var n,r;for(n=ie.Empty,r=t;r.$==1;)n=new ie({$:1,$0:r.$0,$1:n}),r=r.$1;return n},K.head=function(t){return t.$==1?t.$0:K.listEmpty()},K.tail=function(t){return t.$==1?t.$1:K.listEmpty()},K.listEmpty=function(){return oe.FailWith("The input list was empty.")},K.iter=function(t,n){var r;for(r=n;r.$==1;)t(K.head(r)),r=K.tail(r)},K.ofSeq=function(t){var n,r,i,o,u,a;if(t instanceof ie)return t;if(t instanceof h.Array)return K.ofArray(t);n=U.Get(t);try{if(i=n.MoveNext(),!i)r=ie.Empty;else{for(u=new ie({$:1}),o=u;i;)o.$0=n.Current(),n.MoveNext()?o=(a=new ie({$:1}),o.$1=a,a):i=!1;o.$1=ie.Empty,r=u}return r}finally{typeof n=="object"&&"Dispose"in n&&n.Dispose()}},an=Bt.attr=C.Class({},M,an),It.toSafe=function(t){return t??""},Y=g.Doc=C.Class({},M,Y),Y.Concat=function(t){var n;return n=be.ofSeqNonCopying(t),be.TreeReduce(Y.get_Empty(),Y.Append,n)},Y.EmbedView=function(t){var n;return n=I.CreateEmbedNode(),Y.Mk({$:2,$0:n},O.Map(h.ignore,O.Bind(function(r){return I.UpdateEmbedNode(n,r.docNode),r.updates},t)))},Y.TextNode=function(t){return Y.Mk({$:5,$0:self.document.createTextNode(t)},O.Const())},Y.Append=function(t,n){return Y.Mk({$:0,$0:t.docNode,$1:n.docNode},O.Map2Unit(t.updates,n.updates))},Y.get_Empty=function(){return Y.Mk(null,O.Const())},Y.Mk=function(t,n){return new Y.New(t,n)},Y.Element=function(t,n,r){var i,o;return i=ce.Concat(n),o=Y.Concat(r),Ie.New(self.document.createElement(t),i,o)},Y.RunInPlace=function(t,n,r){var i;i=I.CreateRunState(n,r.docNode),O.Sink(de.get_UseAnimations()||zt.BatchUpdatesEnabled()?$n.StartProcessor(I.PerformAnimatedUpdate(t,i,r.docNode)):function(){I.PerformSyncUpdate(t,i,r.docNode)},r.updates)},Y.TextView=function(t){var n;return n=I.CreateTextNode(),Y.Mk({$:4,$0:n},O.Map(function(r){I.UpdateTextNode(n,r)},t))},Y.New=C.Ctor(function(t,n){M.New.call(this),this.docNode=t,this.updates=n},Y),Tn.NewFromSeq=function(t){var n,r,i;n={},r=U.Get(t);try{for(;r.MoveNext();)i=r.Current(),n[i[0]]=i[1]}finally{typeof r=="object"&&"Dispose"in r&&r.Dispose()}return n},Pe.Int=function(){return Pe.set_counter(Pe.counter()+1),Pe.counter()},Pe.set_counter=function(t){ut.$cctor(),ut.counter=t},Pe.counter=function(){return ut.$cctor(),ut.counter},ln.New=function(t,n,r){return{Name:t,Health:n,Inventory:r}},ie=K.T=C.Class({GetEnumerator:function(){return new Ne.New(this,null,function(t){var n;return n=t.s,n.$==0?!1:(t.c=n.$0,t.s=n.$1,!0)},void 0)}},null,ie),ie.Empty=new ie({$:0}),cn.GetFieldValues=function(t){var n;n=[];for(var r in t)n.push(t[r]);return n},b.iteri=function(t,n){var r,i;r=0,i=U.Get(n);try{for(;i.MoveNext();)t(r,i.Current()),r=r+1}finally{typeof i=="object"&&"Dispose"in i&&i.Dispose()}},b.collect=function(t,n){return b.concat(b.map(t,n))},b.append=function(t,n){return{GetEnumerator:function(){var r,i;return r=U.Get(t),i=[!0],new Ne.New(r,null,function(o){var u;return o.s.MoveNext()?(o.c=o.s.Current(),!0):(u=o.s,y.Equals(u,null)||u.Dispose(),o.s=null,i[0]&&(i[0]=!1,o.s=U.Get(n),o.s.MoveNext()?(o.c=o.s.Current(),!0):(o.s.Dispose(),o.s=null,!1)))},function(o){var u;u=o.s,y.Equals(u,null)||u.Dispose()})}}},b.indexed=function(t){return b.mapi(function(n,r){return[n,r]},t)},b.map=function(t,n){return{GetEnumerator:function(){var r;return r=U.Get(n),new Ne.New(null,null,function(i){return r.MoveNext()&&(i.c=t(r.Current()),!0)},function(){r.Dispose()})}}},b.tryFindIndex=function(t,n){var r,i,o;r=U.Get(n);try{for(i=!0,o=0;i&&r.MoveNext();)t(r.Current())?i=!1:o=o+1;return i?null:{$:1,$0:o}}finally{typeof r=="object"&&"Dispose"in r&&r.Dispose()}},b.tryPick=function(t,n){var r,i;r=U.Get(n);try{for(i=null;y.Equals(i,null)&&r.MoveNext();)i=t(r.Current());return i}finally{typeof r=="object"&&"Dispose"in r&&r.Dispose()}},b.concat=function(t){return{GetEnumerator:function(){var n;function r(i){for(var o;;)if(o=i.s,y.Equals(o,null))if(n.MoveNext())i.s=U.Get(n.Current()),i=i;else return n.Dispose(),!1;else{if(o.MoveNext())return i.c=o.Current(),!0;i.Dispose(),i.s=null,i=i}}return n=U.Get(t),new Ne.New(null,null,r,function(i){var o;o=i.s,y.Equals(o,null)||o.Dispose(),y.Equals(n,null)||n.Dispose()})}}},b.mapi=function(t,n){return b.map2(t,b.initInfinite(h.id),n)},b.map2=function(t,n,r){return{GetEnumerator:function(){var i,o;return i=U.Get(n),o=U.Get(r),new Ne.New(null,null,function(u){return i.MoveNext()&&o.MoveNext()&&(u.c=t(i.Current(),o.Current()),!0)},function(){i.Dispose(),o.Dispose()})}}},b.initInfinite=function(t){return{GetEnumerator:function(){return new Ne.New(0,null,function(n){return n.c=t(n.s),n.s=n.s+1,!0},void 0)}}},b.head=function(t){var n;n=U.Get(t);try{return n.MoveNext()?n.Current():b.insufficient()}finally{typeof n=="object"&&"Dispose"in n&&n.Dispose()}},b.forall2=function(t,n,r){return!b.exists2(function(i,o){return!t(i,o)},n,r)},b.rev=function(t){return b.delay(function(){return c.ofSeq(t).slice().reverse()})},b.distinctBy=function(t,n){return{GetEnumerator:function(){var r,i;return r=U.Get(n),i=new se.New$3,new Ne.New(null,null,function(o){var u,a;if(r.MoveNext()){for(u=r.Current(),a=i.SAdd(t(u));!a&&r.MoveNext();)u=r.Current(),a=i.SAdd(t(u));return a&&(o.c=u,!0)}else return!1},function(){r.Dispose()})}}},b.fold=function(t,n,r){var i,o;i=n,o=U.Get(r);try{for(;o.MoveNext();)i=t(i,o.Current());return i}finally{typeof o=="object"&&"Dispose"in o&&o.Dispose()}},b.exists2=function(t,n,r){var i,o,u,a;i=U.Get(n);try{u=U.Get(r);try{for(a=!1;!a&&i.MoveNext()&&u.MoveNext();)a=t(i.Current(),u.Current());o=a}finally{typeof u=="object"&&"Dispose"in u&&u.Dispose()}return o}finally{typeof i=="object"&&"Dispose"in i&&i.Dispose()}},b.delay=function(t){return{GetEnumerator:function(){return U.Get(t())}}},b.distinct=function(t){return b.distinctBy(h.id,t)},b.iter=function(t,n){var r;r=U.Get(n);try{for(;r.MoveNext();)t(r.Current())}finally{typeof r=="object"&&"Dispose"in r&&r.Dispose()}},b.unfold=function(t,n){return{GetEnumerator:function(){return new Ne.New(n,null,function(r){var i;return i=t(r.s),i==null?!1:(r.c=i.$0[0],r.s=i.$0[1],!0)},void 0)}}},b.max=function(t){var n,r,i;n=U.Get(t);try{for(n.MoveNext()||b.seqEmpty(),r=n.Current();n.MoveNext();)i=n.Current(),y.Compare(i,r)===1&&(r=i);return r}finally{typeof n=="object"&&"Dispose"in n&&n.Dispose()}},b.init=function(t,n){return b.take(t,b.initInfinite(n))},b.seqEmpty=function(){return oe.FailWith("The input sequence was empty.")},b.forall=function(t,n){return!b.exists(function(r){return!t(r)},n)},b.take=function(t,n){return t<0&&b.nonNegative(),{GetEnumerator:function(){var r;return r=[U.Get(n)],new Ne.New(0,null,function(i){var o;return i.s=i.s+1,i.s>t?!1:(o=r[0],y.Equals(o,null)?b.insufficient():o.MoveNext()?(i.c=o.Current(),i.s===t&&(o.Dispose(),r[0]=null),!0):(o.Dispose(),r[0]=null,b.insufficient()))},function(){var i;i=r[0],y.Equals(i,null)||i.Dispose()})}}},b.compareWith=function(t,n,r){var i,o,u,a,l;i=U.Get(n);try{u=U.Get(r);try{for(a=0,l=!0;l&&a===0;)i.MoveNext()?a=u.MoveNext()?t(i.Current(),u.Current()):1:u.MoveNext()?a=-1:l=!1;o=a}finally{typeof u=="object"&&"Dispose"in u&&u.Dispose()}return o}finally{typeof i=="object"&&"Dispose"in i&&i.Dispose()}},b.exists=function(t,n){var r,i;r=U.Get(n);try{for(i=!1;!i&&r.MoveNext();)i=t(r.Current());return i}finally{typeof r=="object"&&"Dispose"in r&&r.Dispose()}},sn.New$1=function(t,n){return{Parse:t,Write:n}},Ht.startsWith=function(t,n){var r;switch(t.$==1?n.$==1&&y.Equals(t.$0,n.$0)?(r=[n.$0,n.$1,t.$0,t.$1],1):2:0){case 0:return{$:1,$0:n};case 1:return Ht.startsWith(r[3],r[1]);case 2:return null}},c.ofList=function(t){var n,r;for(r=[],n=t;n.$!=0;)r.push(K.head(n)),n=K.tail(n);return r},c.map2=function(t,n,r){var i,o,u;for(c.checkLength(n,r),i=new h.Array(r.length),o=0,u=r.length-1;o<=u;o++)i[o]=t(n[o],r[o]);return i},c.forall=function(t,n){var r,i,o;for(r=!0,i=0,o=c.length(n);r&&i<o;)t(n[i])?i=i+1:r=!1;return r},c.ofSeq=function(t){var n,r;if(t instanceof h.Array)return t.slice();if(t instanceof ie)return c.ofList(t);n=[],r=U.Get(t);try{for(;r.MoveNext();)n.push(r.Current());return n}finally{typeof r=="object"&&"Dispose"in r&&r.Dispose()}},c.init=function(t,n){var r,i,o;for(t<0&&oe.FailWith("Negative size given."),r=new h.Array(t),i=0,o=t-1;i<=o;i++)r[i]=n(i);return r},c.checkLength=function(t,n){t.length!==n.length&&oe.FailWith("The arrays have different lengths.")},c.choose=function(t,n){var r,i,o,u;for(r=[],i=0,o=n.length-1;i<=o;i++)u=t(n[i]),u==null||r.push(u.$0);return r},c.tryFindIndex=function(t,n){var r,i;for(r=null,i=0;i<n.length&&r==null;)t(n[i])&&(r={$:1,$0:i}),i=i+1;return r},c.tryPick=function(t,n){var r,i,o;for(r=null,i=0;i<n.length&&r==null;)o=t(n[i]),o!=null&&o.$==1&&(r=o),i=i+1;return r},c.concat=function(t){return h.Array.prototype.concat.apply([],c.ofSeq(t))},c.sortInPlace=function(t){c.mapInPlace(function(n){return n[0]},c.mapiInPlace(function(n,r){return[r,n]},t).sort(y.Compare))},c.filter=function(t,n){var r,i,o;for(r=[],i=0,o=n.length-1;i<=o;i++)t(n[i])&&r.push(n[i]);return r},c.iter=function(t,n){var r,i;for(r=0,i=n.length-1;r<=i;r++)t(n[r])},c.exists=function(t,n){var r,i,o;for(r=!1,i=0,o=c.length(n);!r&&i<o;)t(n[i])?r=!0:i=i+1;return r},c.map=function(t,n){var r,i,o;for(r=new h.Array(n.length),i=0,o=n.length-1;i<=o;i++)r[i]=t(n[i]);return r},c.foldBack=function(t,n,r){var i,o,u,a;for(i=r,o=n.length,u=1,a=o;u<=a;u++)i=t(n[o-u],i);return i},c.pick=function(t,n){var r;return r=c.tryPick(t,n),r==null?oe.FailWith("KeyNotFoundException"):r.$0},c.create=function(t,n){var r,i,o;for(r=new h.Array(t),i=0,o=t-1;i<=o;i++)r[i]=n;return r},fn.ofObj=function(t){return t==null?null:{$:1,$0:t}},dt.CompleteHoles=function(t,n,r){var i,o,u,a,l;function f($,A,P){var S;return o.Contains($)?null:(S=y.Equals(A,0)?pe.GetOrAddHoleFor(t,$,function(){return new At.New($,le.Create$1(""))}):y.Equals(A,1)?pe.GetOrAddHoleFor(t,$,function(){return new bt.New($,le.Create$1(0))}):y.Equals(A,2)?pe.GetOrAddHoleFor(t,$,function(){return new St.New($,le.Create$1(!1))}):y.Equals(A,3)?pe.GetOrAddHoleFor(t,$,function(){return new Et.New($,le.Create$1(-864e13))}):y.Equals(A,4)?pe.GetOrAddHoleFor(t,$,function(){return new Tt.New($,le.Create$1([]))}):y.Equals(A,5)?pe.GetOrAddHoleFor(t,$,function(){var x;return x=self.document.querySelector("[ws-dom="+$+"]"),x.removeAttribute("ws-dom"),new pt.New($,le.Create$1({$:1,$0:x}))}):oe.FailWith("Invalid value type"),i.set_Item($,S),{$:1,$0:S})}i=new Ce.New$5,o=new se.New$3,u=U.Get(n);try{for(;u.MoveNext();)a=u.Current(),l=a.get_Name(),o.SAdd(l),i.set_Item(l,a)}finally{typeof u=="object"&&"Dispose"in u&&u.Dispose()}return[b.append(n,c.choose(function($){return f($[0],$[1],$[2])},r)),{$:0,$0:i}]},Me=j.Text=C.Class({get_Name:function(){return this.name},get_Value:function(){return this.fillWith},get_AsChoiceView:function(){return{$:0,$0:this.fillWith}}},ue,Me),Me.New=C.Ctor(function(t,n){ue.New.call(this),this.name=t,this.fillWith=n},Me),L.Replace=function(t,n,r){function i(o){var u,a,l;return u=o.indexOf(n),u!==-1?(a=L.ReplaceOnce(o,n,r),l=u+r.length,L.Substring(a,0,u+r.length)+i(a.substring(l))):o}return i(t)},L.StartsWith=function(t,n){return t.substring(0,n.length)==n},L.ReplaceOnce=function(t,n,r){return t.replace(n,r)},L.Substring=function(t,n,r){return t.substr(n,r)},L.SplitChars=function(t,n,r){return L.Split(t,new h.RegExp("["+L.RegexEscape(n.join(""))+"]"),r)},L.Split=function(t,n,r){return r===1?c.filter(function(i){return i!==""},L.SplitWith(t,n)):L.SplitWith(t,n)},L.RegexEscape=function(t){return t.replace(new h.RegExp("[-\\/\\\\^$*+?.()|[\\]{}]","g"),"\\$&")},L.SplitWith=function(t,n){return t.split(n)},L.concat=function(t,n){return c.ofSeq(n).join(t)},L.IsNullOrEmpty=function(t){return t==null||t==""},L.Join=function(t,n){return n.join(t)},L.forall=function(t,n){return b.forall(t,L.protect(n))},L.protect=function(t){return t??""},ce=g.AttrProxy=C.Class({},null,ce),ce.Create=function(t,n){return W.Static(function(r){r.setAttribute(t,n)})},ce.HandlerImpl=function(t,n){return W.Static(function(r){r.addEventListener(t,function(i){return n(r)(i)},!1)})},ce.Concat=function(t){var n;return n=be.ofSeqNonCopying(t),be.TreeReduce(W.EmptyAttr(),ce.Append,n)},ce.Append=function(t,n){return W.AppendTree(t,n)},ce.Handler=function(t,n){return ce.HandlerImpl(t,n)},be.ofSeqNonCopying=function(t){var n,r;if(t instanceof h.Array)return t;if(t instanceof ie)return c.ofList(t);if(t===null)return[];n=[],r=U.Get(t);try{for(;r.MoveNext();)n.push(r.Current());return n}finally{typeof r=="object"&&"Dispose"in r&&r.Dispose()}},be.TreeReduce=function(t,n,r){var i;function o(u){return function(a){var l;switch(a<=0?0:a===1&&u>=0&&u<i?1:2){case 0:return t;case 1:return c.get(r,u);case 2:return l=a/2>>0,n(o(u)(l),o(u+l)(a-l))}}}return i=c.length(r),o(0)(i)},be.MapTreeReduce=function(t,n,r,i){var o;function u(a){return function(l){var f;switch(l<=0?0:l===1&&a>=0&&a<o?1:2){case 0:return n;case 1:return t(c.get(i,a));case 2:return f=l/2>>0,r(u(a)(f),u(a+f)(l-f))}}}return o=c.length(i),u(0)(o)},I.CreateEmbedNode=function(){return{Current:null,Dirty:!1}},I.UpdateEmbedNode=function(t,n){t.Current=n,t.Dirty=!0},I.CreateRunState=function(t,n){return wn.New($e.get_Empty(),I.CreateElemNode(t,W.EmptyAttr(),n))},I.PerformAnimatedUpdate=function(t,n,r){return de.get_UseAnimations()?H.Delay(function(){var i,o,u;return i=$e.FindAll(r),o=I.ComputeChangeAnim(n,i),u=I.ComputeEnterAnim(n,i),H.Bind(de.Play(de.Append(o,I.ComputeExitAnim(n,i))),function(){return H.Bind(I.SyncElemNodesNextFrame(t,n),function(){return H.Bind(de.Play(u),function(){return n.PreviousNodes=i,H.Return(null)})})})}):I.SyncElemNodesNextFrame(t,n)},I.PerformSyncUpdate=function(t,n,r){var i;i=$e.FindAll(r),I.SyncElemNode(t,n.Top),n.PreviousNodes=i},I.LinkElement=function(t,n){I.InsertDoc(t,n,null)},I.InsertBeforeDelim=function(t,n){var r,i;return r=t.parentNode,i=self.document.createTextNode(""),r.insertBefore(i,t),I.LinkPrevElement(t,n),i},I.CreateElemNode=function(t,n,r){var i;return I.LinkElement(t,r),i=W.Insert(t,n),Ye.New(i,r,null,t,Pe.Int(),C.GetOptional(i.OnAfterRender))},I.SyncElemNodesNextFrame=function(t,n){function r(i){h.requestAnimationFrame(function(){I.SyncElemNode(t,n.Top),i()})}return zt.BatchUpdatesEnabled()?H.FromContinuations(function(i,o,u){return r.apply(null,[i,o,u])}):(I.SyncElemNode(t,n.Top),H.Return(null))},I.ComputeExitAnim=function(t,n){return de.Concat(c.map(function(r){return W.GetExitAnim(r.Attr)},$e.ToArray($e.Except(n,$e.Filter(function(r){return W.HasExitAnim(r.Attr)},t.PreviousNodes)))))},I.ComputeEnterAnim=function(t,n){return de.Concat(c.map(function(r){return W.GetEnterAnim(r.Attr)},$e.ToArray($e.Except(t.PreviousNodes,$e.Filter(function(r){return W.HasEnterAnim(r.Attr)},n)))))},I.ComputeChangeAnim=function(t,n){var r;function i(o){return W.HasChangeAnim(o.Attr)}return r=function(o){return $e.Filter(i,o)},de.Concat(c.map(function(o){return W.GetChangeAnim(o.Attr)},$e.ToArray($e.Intersect(r(t.PreviousNodes),r(n)))))},I.SyncElemNode=function(t,n){t||I.SyncElement(n),I.Sync(n.Children),I.AfterRender(n)},I.CreateTextNode=function(){return{Text:self.document.createTextNode(""),Dirty:!1,Value:""}},I.UpdateTextNode=function(t,n){t.Value=n,t.Dirty=!0},I.InsertDoc=function(t,n,r){for(var i,o,u;;){if(n!=null&&n.$==1)return I.InsertNode(t,n.$0.El,r);if(n!=null&&n.$==2)i=n.$0,i.Dirty=!1,n=i.Current;else{if(n==null)return r;if(n!=null&&n.$==4)return I.InsertNode(t,n.$0.Text,r);if(n!=null&&n.$==5)return I.InsertNode(t,n.$0,r);if(n!=null&&n.$==6)return c.foldBack(function(a,l){return C.Curried3(function(f,$,A){return $==null||$.constructor===vt?I.InsertDoc(f,$,A):I.InsertNode(f,$,A)})(t)(a)(l)},n.$0.Els,r);o=n.$1,u=n.$0,n=u,r=I.InsertDoc(t,o,r)}}},I.LinkPrevElement=function(t,n){I.InsertDoc(t.parentNode,n,t)},I.SyncElement=function(t){function n(r){function i(o){for(var u,a,l,f;;)if(o!=null&&o.$==0){if(a=o.$1,l=o.$0,i(l))return!0;o=a}else if(o!=null&&o.$==2){if(f=o.$0,f.Dirty)return!0;o=f.Current}else return o!=null&&o.$==6&&(u=o.$0,u.Dirty||c.exists(n,u.Holes))}return i(r.Children)}W.Sync(t.El,t.Attr),n(t)&&I.DoSyncElement(t)},I.Sync=function(t){for(var n,r,i,o,u;;){if(t!=null&&t.$==1)return I.SyncElemNode(!1,t.$0);if(t!=null&&t.$==2)i=t.$0,t=i.Current;else{if(t==null)return null;if(t!=null&&t.$==5)return null;if(t!=null&&t.$==4)return n=t.$0,n.Dirty?(n.Text.nodeValue=n.Value,n.Dirty=!1):null;if(t!=null&&t.$==6)return r=t.$0,c.iter(function(a){I.SyncElemNode(!1,a)},r.Holes),c.iter(function(a){W.Sync(a[0],a[1])},r.Attrs),I.AfterRender(r);o=t.$1,u=t.$0,I.Sync(u),t=o}}},I.AfterRender=function(t){var n;n=C.GetOptional(t.Render),n!=null&&n.$==1&&(n.$0(t.El),C.SetOptional(t,"Render",null))},I.InsertNode=function(t,n,r){return ae.InsertAt(t,r,n),n},I.DoSyncElement=function(t){var n,r,i;function o(u,a){for(var l,f,$,A;;){if(u!=null&&u.$==1)return u.$0.El;if(u!=null&&u.$==2){if(f=u.$0,f.Dirty)return f.Dirty=!1,I.InsertDoc(n,f.Current,a);u=f.Current}else{if(u==null)return a;if(u!=null&&u.$==4)return u.$0.Text;if(u!=null&&u.$==5)return u.$0;if(u!=null&&u.$==6)return l=u.$0,l.Dirty&&(l.Dirty=!1),c.foldBack(function(P,S){return P==null||P.constructor===vt?o(P,S):P},l.Els,a);$=u.$1,A=u.$0,u=A,a=o($,a)}}}n=t.El,Xe.Iter((r=t.El,function(u){ae.RemoveNode(r,u)}),Xe.Except(Xe.DocChildren(t),Xe.Children(t.El,C.GetOptional(t.Delimiters)))),o(t.Children,(i=C.GetOptional(t.Delimiters),i!=null&&i.$==1?i.$0[1]:null))},p.Obsolete=function(t){var n,r,i,o,u;if(r=t.s,!(r==null||(!(r!=null&&r.$==2||r!=null&&r.$==3)||(n=r.$1,!1))))for(t.s=null,i=0,o=c.length(n)-1;i<=o;i++)u=c.get(n,i),typeof u=="object"?function(a){p.Obsolete(a)}(u):u()},p.New=function(t){return{s:t}},qt.TryParseInt32=function(t,n){return qt.TryParse(t,-2147483648,2147483647,n)},U.Get=function(t){return t instanceof h.Array?U.ArrayEnumerator(t):y.Equals(typeof t,"string")?U.StringEnumerator(t):t.GetEnumerator()},U.ArrayEnumerator=function(t){return new Ne.New(0,null,function(n){var r;return r=n.s,r<c.length(t)&&(n.c=c.get(t,r),n.s=r+1,!0)},void 0)},U.StringEnumerator=function(t){return new Ne.New(0,null,function(n){var r;return r=n.s,r<t.length&&(n.c=t[r],n.s=r+1,!0)},void 0)},U.Get0=function(t){return t instanceof h.Array?U.ArrayEnumerator(t):y.Equals(typeof t,"string")?U.StringEnumerator(t):"GetEnumerator0"in t?t.GetEnumerator0():t.GetEnumerator()},Se=ne.FSharpMap=C.Class({GetEnumerator:function(){return U.Get(b.map(function(t){return{K:t.Key,V:t.Value}},Q.Enumerate(!1,this.tree)))},Equals:function(t){return this.Count()===t.Count()&&b.forall2(y.Equals,this,t)},Count:function(){var t;return t=this.tree,t==null?0:t.Count},Add$1:function(t,n){return new Se.New$1(Q.Add(at.New(t,n),this.tree))},get_IsEmpty:function(){return this.tree==null},GetHashCode:function(){return y.Hash(c.ofSeq(this))},get_Tree:function(){return this.tree},CompareTo0:function(t){return b.compareWith(y.Compare,this,t)}},M,Se),Se.New=C.Ctor(function(t){Se.New$1.call(this,pn.fromSeq(t))},Se),Se.New$1=C.Ctor(function(t){M.New.call(this),this.tree=t},Se),Ne=U.T=C.Class({MoveNext:function(){var t;return t=this.n(this),this.e=t?1:2,t},Current:function(){return this.e===1?this.c:this.e===0?oe.FailWith("Enumeration has not started. Call MoveNext."):oe.FailWith("Enumeration already finished.")},Dispose:function(){this.d&&this.d(this)}},M,Ne),Ne.New=C.Ctor(function(t,n,r,i){M.New.call(this),this.s=t,this.c=n,this.n=r,this.d=i,this.e=0},Ne),ot.OfArray=function(t){return new Se.New$1(Q.OfSeq(b.map(function(n){return at.New(n[0],n[1])},t)))},ot.FoldBack=function(t,n,r){return b.fold(function(i,o){return t(o.Key,o.Value,i)},r,Q.Enumerate(!0,n.get_Tree()))},ot.ToSeq=function(t){return b.map(function(n){return[n.Key,n.Value]},Q.Enumerate(!1,t.get_Tree()))},H.scheduler=function(){return xe.$cctor(),xe.scheduler},H.Return=function(t){return function(n){n.k({$:0,$0:t})}},H.Delay=function(t){return function(n){try{t(null)(n)}catch(r){n.k({$:1,$0:r})}}},H.Bind=function(t,n){return H.checkCancel(function(r){t(Xt.New(function(i){var o;i.$==0?(o=i.$0,H.scheduler().Fork(function(){try{n(o)(r)}catch(u){r.k({$:1,$0:u})}})):H.scheduler().Fork(function(){r.k(i)})},r.ct))})},H.Zero=function(){return xe.$cctor(),xe.Zero},H.Start=function(t,n){var r,i;r=(i=H.defCTS()[0],n==null?i:n.$0),H.scheduler().Fork(function(){r.c||t(Xt.New(function(o){o.$==1&&H.UncaughtAsyncError(o.$0)},r))})},H.checkCancel=function(t){return function(n){n.ct.c?H.cancel(n):t(n)}},H.defCTS=function(){return xe.$cctor(),xe.defCTS},H.UncaughtAsyncError=function(t){me.log("WebSharper: Uncaught asynchronous exception",t)},H.FromContinuations=function(t){return function(n){var r;function i(o){r[0]?oe.FailWith("A continuation provided by Async.FromContinuations was invoked multiple times"):(r[0]=!0,H.scheduler().Fork(o))}r=[!1],t(function(o){i(function(){n.k({$:0,$0:o})})},function(o){i(function(){n.k({$:1,$0:o})})},function(o){i(function(){n.k({$:2,$0:o})})})}},H.cancel=function(t){t.k({$:2,$0:new Be.New(t.ct)})},Ce=ne.Dictionary=C.Class({set_Item:function(t,n){this.set(t,n)},set:function(t,n){var r,i,o,u;r=this,i=this.hash(t),o=this.data[i],o==null?(this.count=this.count+1,this.data[i]=new h.Array({K:t,V:n})):(u=c.tryFindIndex(function(a){return r.equals.apply(null,[oe.KeyValue(a)[0],t])},o),u==null?(this.count=this.count+1,o.push({K:t,V:n})):o[u.$0]={K:t,V:n})},TryGetValue:function(t,n){var r,i,o;return r=this,i=this.data[this.hash(t)],i==null?!1:(o=c.tryPick(function(u){var a;return a=oe.KeyValue(u),r.equals.apply(null,[a[0],t])?{$:1,$0:a[1]}:null},i),o!=null&&o.$==1&&(n.set(o.$0),!0))},GetEnumerator:function(){return U.Get0(c.concat(cn.GetFieldValues(this.data)))},ContainsKey:function(t){var n,r;return n=this,r=this.data[this.hash(t)],r==null?!1:c.exists(function(i){return n.equals.apply(null,[oe.KeyValue(i)[0],t])},r)},Item:function(t){return this.get(t)},Values:function(){return new Ft.New(this)},RemoveKey:function(t){return this.remove(t)},Keys:function(){return new Dt.New(this)},get:function(t){var n,r;return n=this,r=this.data[this.hash(t)],r==null?dn.notPresent():c.pick(function(i){var o;return o=oe.KeyValue(i),n.equals.apply(null,[o[0],t])?{$:1,$0:o[1]}:null},r)},remove:function(t){var n,r,i,o;return n=this,r=this.hash(t),i=this.data[r],i==null?!1:(o=c.filter(function(u){return!n.equals.apply(null,[oe.KeyValue(u)[0],t])},i),c.length(o)<i.length&&(this.count=this.count-1,this.data[r]=o,!0))}},M,Ce),Ce.New$5=C.Ctor(function(){Ce.New$6.call(this,[],y.Equals,y.Hash)},Ce),Ce.New$6=C.Ctor(function(t,n,r){var i,o;M.New.call(this),this.equals=n,this.hash=r,this.count=0,this.data=[],i=U.Get(t);try{for(;i.MoveNext();)o=i.Current(),this.set(o.K,o.V)}finally{typeof i=="object"&&"Dispose"in i&&i.Dispose()}},Ce),se=ne.HashSet=C.Class({SAdd:function(t){return this.add(t)},Contains:function(t){var n;return n=this.data[this.hash(t)],n==null?!1:this.arrContains(t,n)},add:function(t){var n,r;return n=this.hash(t),r=this.data[n],r==null?(this.data[n]=[t],this.count=this.count+1,!0):this.arrContains(t,r)?!1:(r.push(t),this.count=this.count+1,!0)},arrContains:function(t,n){var r,i,o;for(r=!0,i=0,o=n.length;r&&i<o;)this.equals.apply(null,[n[i],t])?r=!1:i=i+1;return!r},GetEnumerator:function(){return U.Get(Lt.concat(this.data))},ExceptWith:function(t){var n;n=U.Get(t);try{for(;n.MoveNext();)this.Remove(n.Current())}finally{typeof n=="object"&&"Dispose"in n&&n.Dispose()}},Count:function(){return this.count},IntersectWith:function(t){var n,r,i,o,u;for(n=new se.New$4(t,this.equals,this.hash),r=Lt.concat(this.data),i=0,o=r.length-1;i<=o;i++)u=r[i],n.Contains(u)||this.Remove(u)},Remove:function(t){var n;return n=this.data[this.hash(t)],n==null?!1:this.arrRemove(t,n)&&(this.count=this.count-1,!0)},CopyTo:function(t,n){var r,i,o;for(r=Lt.concat(this.data),i=0,o=r.length-1;i<=o;i++)c.set(t,i+n,r[i])},arrRemove:function(t,n){var r,i,o;for(r=!0,i=0,o=n.length;r&&i<o;)this.equals.apply(null,[n[i],t])?(n.splice.apply(n,[i,1]),r=!1):i=i+1;return!r}},M,se),se.New$3=C.Ctor(function(){se.New$4.call(this,[],y.Equals,y.Hash)},se),se.New$4=C.Ctor(function(t,n,r){var i;M.New.call(this),this.equals=n,this.hash=r,this.data=[],this.count=0,i=U.Get(t);try{for(;i.MoveNext();)this.add(i.Current())}finally{typeof i=="object"&&"Dispose"in i&&i.Dispose()}},se),se.New$2=C.Ctor(function(t){se.New$4.call(this,t,y.Equals,y.Hash)},se),pe.$cctor=function(){pe.$cctor=h.ignore,pe.initialized=new Ce.New$5},pe=De.TemplateInitializer=C.Class({},M,pe),pe.GetOrAddHoleFor=function(t,n,r){var i,o,u,a;return pe.$cctor(),i=pe.GetHolesFor(t),o=(u=null,[i.TryGetValue(n,{get:function(){return u},set:function(l){u=l}}),u]),o[0]?o[1]:(a=r(),i.set_Item(n,a),a)},pe.GetHolesFor=function(t){var n,r,i;return pe.$cctor(),n=(r=null,[pe.initialized.TryGetValue(t,{get:function(){return r},set:function(o){r=o}}),r]),n[0]?n[1]:(i=new Ce.New$5,pe.initialized.set_Item(t,i),i)},At=j.VarStr=C.Class({get_Name:function(){return this.name},ForTextView:function(){return{$:1,$0:this.fillWith.get_View()}},AddAttribute:function(t,n){t(n)(ee.Value(this.fillWith))},get_AsChoiceView:function(){return{$:1,$0:O.Map(h.String,this.fillWith.get_View())}}},ue,At),At.New=C.Ctor(function(t,n){ue.New.call(this),this.name=t,this.fillWith=n},At),bt=j.VarFloatUnchecked=C.Class({get_Name:function(){return this.name},ForTextView:function(){return{$:1,$0:O.Map(h.String,this.fillWith.get_View())}},AddAttribute:function(t,n){t(n)(ee.FloatValueUnchecked(this.fillWith))},get_AsChoiceView:function(){return{$:1,$0:O.Map(h.String,this.fillWith.get_View())}}},ue,bt),bt.New=C.Ctor(function(t,n){ue.New.call(this),this.name=t,this.fillWith=n},bt),St=j.VarBool=C.Class({get_Name:function(){return this.name},ForTextView:function(){return{$:1,$0:O.Map(h.String,this.fillWith.get_View())}},AddAttribute:function(t,n){t(n)(ee.Checked(this.fillWith))},get_AsChoiceView:function(){return{$:1,$0:O.Map(h.String,this.fillWith.get_View())}}},ue,St),St.New=C.Ctor(function(t,n){ue.New.call(this),this.name=t,this.fillWith=n},St),Et=j.VarDateTime=C.Class({get_Name:function(){return this.name},ForTextView:function(){return{$:1,$0:O.Map(function(t){return new h.Date(t).toLocaleString()},this.fillWith.get_View())}},AddAttribute:function(t,n){t(n)(ee.DateTimeValue(this.fillWith))},get_AsChoiceView:function(){return{$:1,$0:O.Map(function(t){return new h.Date(t).toLocaleString()},this.fillWith.get_View())}}},ue,Et),Et.New=C.Ctor(function(t,n){ue.New.call(this),this.name=t,this.fillWith=n},Et),Tt=j.VarFile=C.Class({get_Name:function(){return this.name},ForTextView:function(){return{$:1,$0:O.Map(h.String,this.fillWith.get_View())}},AddAttribute:function(t,n){t(n)(ee.FileValue(this.fillWith))},get_AsChoiceView:function(){return{$:1,$0:O.Map(h.String,this.fillWith.get_View())}}},ue,Tt),Tt.New=C.Ctor(function(t,n){ue.New.call(this),this.name=t,this.fillWith=n},Tt),pt=j.VarDomElement=C.Class({get_Name:function(){return this.name},get_Value:function(){return this.fillWith}},ue,pt),pt.New=C.Ctor(function(t,n){ue.New.call(this),this.name=t,this.fillWith=n},pt),v.RunFullDocTemplate=function(t){var n,r,i;return v.RenderedFullDocTemplate()==null?(n=(v.LoadLocalTemplates(""),v.PrepareTemplateStrict("",null,self.document.body,null),r=v.ChildrenTemplate(self.document.body,t),i=self.document.body,function(o){Y.RunInPlace(!0,i,o)}(r),r),v.set_RenderedFullDocTemplate({$:1,$0:n}),n):v.RenderedFullDocTemplate().$0},v.LoadLocalTemplates=function(t){v.LocalTemplatesLoaded()||(v.set_LocalTemplatesLoaded(!0),v.LoadNestedTemplates(self.document.body,"")),v.LoadedTemplates().set_Item(t,v.LoadedTemplateFile(""))},v.NamedTemplate=function(t,n,r){var i,o;return i=(o=null,[v.LoadedTemplateFile(t).TryGetValue(n==null?"":n.$0,{get:function(){return o},set:function(u){o=u}}),o]),i[0]?v.ChildrenTemplate(i[1].cloneNode(!0),r):(me.warn("Local template doesn't exist",n),Y.get_Empty())},v.RenderedFullDocTemplate=function(){return fe.$cctor(),fe.RenderedFullDocTemplate},v.PrepareTemplateStrict=function(t,n,r,i){var o,u;function a(S,x){var E,T,V,N,k,D,F,G,q,re,X,J,ye,Re,He,Ve,Ee,et,tt,_t,ke,nt,rt,Rt,ct;function bn(qe){}for(;;)switch(S){case 0:if(x!==null)E=x.nextSibling,y.Equals(x.nodeType,Qe.TEXT_NODE)?he.convertTextNode(x):y.Equals(x.nodeType,Qe.ELEMENT_NODE)&&f(x),x=E;else return null;break;case 1:if(k=_e.string(x.nodeName,{$:1,$0:3},null).toLowerCase(),D=(T=k.indexOf("."),T===-1?[t,k]:[_e.string(k,null,{$:1,$0:T-1}),_e.string(k,{$:1,$0:T+1},null)]),F=D[1],G=D[0],G!=""&&!v.LoadedTemplates().ContainsKey(G))return he.failNotLoaded(F);if(G==""&&i!=null&&i.$0(F),q=v.LoadedTemplates().Item(G),q.ContainsKey(F)){for(re=q.Item(F),X=re.cloneNode(!0),J=new se.New$3,ye=new Ce.New$5,Re=x.attributes,He=0,Ve=Re.length-1;He<=Ve;He++)Ee=Re.item(He).name.toLowerCase(),ye.set_Item(Ee,(et=Re.item(He).nodeValue,et==""?Ee:et.toLowerCase())),J.SAdd(Ee)||me.warn("Hole mapped twice",Ee);for(tt=0,_t=x.childNodes.length-1;tt<=_t;tt++)ke=x.childNodes[tt],y.Equals(ke.nodeType,Qe.ELEMENT_NODE)&&(J.SAdd(ke.nodeName.toLowerCase())||me.warn("Hole filled twice",F));if(nt=x.childNodes.length===1&&y.Equals(x.firstChild.nodeType,Qe.TEXT_NODE),nt&&(V=he.fillTextHole(X,x.firstChild.textContent,F),function(qe){return function(st){st!=null&&qe(st.$0)}}((N=function(qe){return function(st){return qe.SAdd(st)}}(J),function(qe){return N(qe),void 0}))(V)),he.removeHolesExcept(X,J),!nt)for(rt=0,Rt=x.childNodes.length-1;rt<=Rt;rt++)ct=x.childNodes[rt],y.Equals(ct.nodeType,Qe.ELEMENT_NODE)&&(ct.hasAttributes()?he.fillInstanceAttrs(X,ct):l(X,ct));he.mapHoles(X,ye),he.fill(X,x.parentNode,x),x.parentNode.removeChild(x);return}else return he.failNotLoaded(F)}}function l(S,x){var E,T,V,N;function k(D,F){var G;if(V=="title"&&x.hasChildNodes())for(G=ae.ParseHTMLIntoFakeRoot(x.textContent),x.removeChild(x.firstChild);G.hasChildNodes();)x.appendChild(G.firstChild);return f(x),he.fill(x,D,F)}if(V=x.nodeName.toLowerCase(),v.foreachNotPreserved(S,"[ws-attr-holes]",function(D){var F,G,q,re,X;for(F=L.SplitChars(D.getAttribute("ws-attr-holes"),[" "],1),G=0,q=F.length-1;G<=q;G++)re=c.get(F,G),D.setAttribute(re,(X=new h.RegExp("\\${"+V+"}","ig"),D.getAttribute(re).replace(X,x.textContent)))}),N=S.querySelector("[ws-hole="+V+"]"),y.Equals(N,null))return E=S.querySelector("[ws-replace="+V+"]"),y.Equals(E,null)?(T=S.querySelector("slot[name="+V+"]"),S.tagName.toLowerCase()=="template"?(k(T.parentNode,T),void T.parentNode.removeChild(T)):null):(k(E.parentNode,E),void E.parentNode.removeChild(E));for(;N.hasChildNodes();)N.removeChild(N.lastChild);return N.removeAttribute("ws-hole"),k(N,null)}function f(S){S.hasAttribute("ws-preserve")||(L.StartsWith(S.nodeName.toLowerCase(),"ws-")?A(S):(he.convertAttrs(S),$(S.firstChild)))}function $(S){return a(0,S)}function A(S){return a(1,S)}function P(S){for(var x,E,T,V,N,k,D,F,G,q,re,X;;)if(x=S.querySelector("[ws-template]"),y.Equals(x,null))if(E=S.querySelector("[ws-children-template]"),y.Equals(E,null)){for(T=S.querySelectorAll("template[id]"),V=1,N=T.length-1;V<=N;V++)k=T[V],o.Contains(k)||(v.PrepareTemplateStrict(t,{$:1,$0:k.getAttribute("id")},k,null),o.SAdd(k));for(D=S.querySelectorAll("template[name]"),F=1,G=D.length-1;F<=G;F++)q=D[F],o.Contains(q)||(v.PrepareTemplateStrict(t,{$:1,$0:q.getAttribute("name")},q,null),o.SAdd(q));return null}else re=E.getAttribute("ws-children-template"),E.removeAttribute("ws-children-template"),v.PrepareTemplateStrict(t,{$:1,$0:re},E,null),S=S;else X=x.getAttribute("ws-template"),v.PrepareSingleTemplate(t,{$:1,$0:X},x)(null),S=S}o=new se.New$3,u=(n==null?"":n.$0).toLowerCase(),v.LoadedTemplateFile(t).set_Item(u,r),r.hasChildNodes()&&(P(r),$(r.firstChild))},v.ChildrenTemplate=function(t,n){var r,i,o,u;return r=v.InlineTemplate(t,b.append(n,v.GlobalHoles().Values())),i=r[1],o=r[0],u=o.Els,!y.Equals(u,null)&&u.length===1&&c.get(u,0)instanceof Qe&&y.Equals(c.get(u,0).nodeType,Qe.ELEMENT_NODE)&&(c.get(u,0),!0)?Ie.TreeNode(o,i):Y.Mk({$:6,$0:o},i)},v.set_RenderedFullDocTemplate=function(t){fe.$cctor(),fe.RenderedFullDocTemplate=t},v.LocalTemplatesLoaded=function(){return fe.$cctor(),fe.LocalTemplatesLoaded},v.set_LocalTemplatesLoaded=function(t){fe.$cctor(),fe.LocalTemplatesLoaded=t},v.LoadNestedTemplates=function(t,n){var r,i,o,u,a,l,f,$,A,P,S,x,E,T,V,N,k,D,F,G,q;function re(X){var J,ye;r.ContainsKey(X)||(J=(ye=null,[i.TryGetValue(X,{get:function(){return ye},set:function(Re){ye=Re}}),ye]),J[0]?(q.SAdd(X),i.RemoveKey(X),v.PrepareTemplateStrict(n,{$:1,$0:X},J[1],{$:1,$0:re})):me.warn(q.Contains(X)?"Encountered loop when instantiating "+X:"Local template does not exist: "+X))}for(r=v.LoadedTemplateFile(n),i=new Ce.New$5,o=t.querySelectorAll("[ws-template]"),u=0,a=o.length-1;u<=a;u++)l=o[u],f=l.getAttribute("ws-template").toLowerCase(),l.removeAttribute("ws-template"),i.set_Item(f,v.FakeRootSingle(l));for($=t.querySelectorAll("[ws-children-template]"),A=0,P=$.length-1;A<=P;A++)S=$[A],x=S.getAttribute("ws-children-template").toLowerCase(),S.removeAttribute("ws-children-template"),i.set_Item(x,v.FakeRoot(S));for(E=t.querySelectorAll("template[id]"),T=0,V=E.length-1;T<=V;T++)N=E[T],i.set_Item(N.getAttribute("id").toLowerCase(),v.FakeRootFromHTMLTemplate(N));for(k=t.querySelectorAll("template[name]"),D=0,F=k.length-1;D<=F;D++)G=k[D],i.set_Item(G.getAttribute("name").toLowerCase(),v.FakeRootFromHTMLTemplate(G));for(q=new se.New$3;i.count>0;)re(b.head(i.Keys()))},v.LoadedTemplates=function(){return fe.$cctor(),fe.LoadedTemplates},v.LoadedTemplateFile=function(t){var n,r,i;return n=(r=null,[v.LoadedTemplates().TryGetValue(t,{get:function(){return r},set:function(o){r=o}}),r]),n[0]?n[1]:(i=new Ce.New$5,v.LoadedTemplates().set_Item(t,i),i)},v.foreachNotPreserved=function(t,n,r){ae.IterSelector(t,n,function(i){i.closest("[ws-preserve]")==null&&r(i)})},v.PrepareSingleTemplate=function(t,n,r){var i;return i=v.FakeRootSingle(r),function(o){v.PrepareTemplateStrict(t,n,i,o)}},v.InlineTemplate=function(t,n){var r,i,o,u,a,l,f,$,A,P,S,x;function E(N,k){var D,F,G;return D=W.Insert(N,k),f.push(W.Updates(D)),$.push([N,D]),F=C.GetOptional(D.OnAfterRender),F==null?null:(G=F.$0,void A.push(function(){G(N)}))}function T(N){var k,D,F,G;return k=(D=null,[P.TryGetValue(N,{get:function(){return D},set:function(q){D=q}}),D]),k[0]?(F=k[1],F instanceof it?{$:1,$0:F.get_Value()}:F instanceof Me?{$:1,$0:Y.TextNode(F.get_Value())}:(G=F.ForTextView(),G==null?null:{$:1,$0:Y.TextView(G.$0)})):null}function V(){v.foreachNotPreservedwsDOM("[ws-dom]",function(N){var k,D,F,G,q,re,X;k=(D=null,[P.TryGetValue(N.getAttribute("ws-dom").toLowerCase(),{get:function(){return D},set:function(J){D=J}}),D]),k[0]&&(F=k[1],F instanceof pt&&(G=F.get_Value(),N.removeAttribute("ws-dom"),q=N,re=new h.MutationObserver(function(J,ye){c.iter(function(Re){function He(Ve,Ee,et,tt){Ve===q&&Re.addedNodes.length!==1&&(G.SetFinal(null),ye.disconnect())}Re.removedNodes.forEach(C.CreateFuncWithArgs(function(Ve){return He(Ve[0],Ve[1],Ve[2],Ve[3])}),null)},J)}),N.parentElement!==null&&re.observe(N.parentElement,(X={},X.childList=!0,X)),G.Set({$:1,$0:N}),O.Sink(function(J){var ye;J!=null&&J.$==1?(ye=J.$0,q===ye||(q.replaceWith.apply(q,[ye]),q=ye)):(q.remove(),re.disconnect())},G.get_View())))})}l=[],f=[],$=[],A=[],P=new Ce.New$5,S=U.Get(n);try{for(;S.MoveNext();)x=S.Current(),P.set_Item(x.get_Name(),x)}finally{typeof S=="object"&&"Dispose"in S&&S.Dispose()}return r=ae.ChildrenArray(t),v.foreachNotPreserved(t,"[ws-hole]",function(N){var k,D,F;for(F=N.getAttribute("ws-hole"),N.removeAttribute("ws-hole");N.hasChildNodes();)N.removeChild(N.lastChild);k=T(F),k!=null&&k.$==1&&(D=k.$0,I.LinkElement(N,D.docNode),l.push(Ye.New(W.Empty(N),D.docNode,null,N,Pe.Int(),null)),f.push(D.updates))}),v.foreachNotPreserved(t,"[ws-replace]",function(N){var k,D,F,G,q,re;k=T(N.getAttribute("ws-replace")),k!=null&&k.$==1&&(D=k.$0,F=N.parentNode,G=self.document.createTextNode(""),F.replaceChild(G,N),q=I.InsertBeforeDelim(G,D.docNode),re=c.tryFindIndex(function(X){return N===X},r),re==null||c.set(r,re.$0,D.docNode),l.push(Ye.New(W.Empty(F),D.docNode,{$:1,$0:[q,G]},F,Pe.Int(),null)),f.push(D.updates))}),i=!1,v.foreachNotPreserved(t,"slot",function(N){var k,D,F,G;if(F=N.getAttribute("name"),G=F==""||F==null?"default":F.toLowerCase(),!(i&&G=="default"||!y.Equals(t.parentElement,null))){for(;N.hasChildNodes();)N.removeChild(N.lastChild);G=="default"&&(i=!0),k=T(G),k!=null&&k.$==1&&(D=k.$0,I.LinkElement(N,D.docNode),l.push(Ye.New(W.Empty(N),D.docNode,null,N,Pe.Int(),null)),f.push(D.updates))}}),v.foreachNotPreserved(t,"[ws-attr]",function(N){var k,D,F,G;k=N.getAttribute("ws-attr"),N.removeAttribute("ws-attr"),D=(F=null,[P.TryGetValue(k,{get:function(){return F},set:function(q){F=q}}),F]),D[0]&&(G=D[1],G instanceof jt?E(N,G.get_Value()):me.warn("Attribute hole filled with non-attribute data",k))}),v.foreachNotPreserved(t,"[ws-on]",function(N){E(N,ce.Concat(c.choose(function(k){var D,F,G,q;return D=L.SplitChars(k,[":"],1),F=(G=null,[P.TryGetValue(c.get(D,1),{get:function(){return G},set:function(re){G=re}}),G]),F[0]?(q=F[1],q instanceof Qt?{$:1,$0:ee.Handler(c.get(D,0),q.get_Value())}:q instanceof Jt?{$:1,$0:ce.Handler(c.get(D,0),q.get_Value())}:(me.warn("Event hole on"+c.get(D,0)+" filled with non-event data",c.get(D,1)),null)):null},L.SplitChars(N.getAttribute("ws-on"),[" "],1)))),N.removeAttribute("ws-on")}),v.foreachNotPreserved(t,"[ws-onafterrender]",function(N){var k,D,F,G;k=N.getAttribute("ws-onafterrender"),D=(F=null,[P.TryGetValue(k,{get:function(){return F},set:function(q){F=q}}),F]),D[0]&&(G=D[1],G instanceof Yt||G instanceof Zt?(N.removeAttribute("ws-onafterrender"),E(N,ee.OnAfterRender(G.get_Value()))):me.warn("onafterrender hole filled with non-onafterrender data",k))}),v.foreachNotPreserved(t,"[ws-var]",function(N){var k,D,F;k=N.getAttribute("ws-var"),N.removeAttribute("ws-var"),D=(F=null,[P.TryGetValue(k,{get:function(){return F},set:function(G){F=G}}),F]),D[0]&&D[1].AddAttribute(function(G){return function(q){return E(G,q)}},N)}),v.foreachNotPreserved(t,"[ws-attr-holes]",function(N){var k,D,F,G;for(k=new h.RegExp(v.TextHoleRE(),"g"),D=L.SplitChars(N.getAttribute("ws-attr-holes"),[" "],1),N.removeAttribute("ws-attr-holes"),F=0,G=D.length-1;F<=G;F++)(function(){var q,re,X,J,ye,Re,He,Ve,Ee,et,tt,_t;for(Ee=c.get(D,F),et=N.getAttribute(Ee),q=null,re=0,tt=[];q=k.exec(et),q!==null;)_t=_e.string(et,{$:1,$0:re},{$:1,$0:k.lastIndex-c.get(q,0).length-1}),re=k.lastIndex,tt.push([_t,c.get(q,1)]);return X=_e.string(et,{$:1,$0:re},null),k.lastIndex=0,J=c.foldBack(function(ke,nt){return function(rt){var Rt,ct;return Rt=rt[0],ct=rt[1],function(bn){var qe,st,Ut,Sn,tn;return qe=bn[0],st=bn[1],Ut=(Sn=(tn=null,[P.TryGetValue(ct,{get:function(){return tn},set:function(En){tn=En}}),tn]),Sn[0]?Sn[1].get_AsChoiceView():{$:0,$0:""}),Ut.$==1?[Rt,new ie({$:1,$0:qe==""?Ut.$0:O.Map(function(En){return En+qe},Ut.$0),$1:st})]:[Rt+Ut.$0+qe,st]}}(ke)(nt)},tt,[X,ie.Empty]),E(N,J[1].$==1?J[1].$1.$==1?J[1].$1.$1.$==1?J[1].$1.$1.$1.$==0?(ye=J[0],ee.Dynamic(Ee,O.Map3(function(ke,nt,rt){return ye+ke+nt+rt},J[1].$0,J[1].$1.$0,J[1].$1.$1.$0))):(Re=J[0],ee.Dynamic(Ee,O.Map(function(ke){return Re+L.concat("",ke)},O.Sequence(J[1])))):(He=J[0],ee.Dynamic(Ee,O.Map2(function(ke,nt){return He+ke+nt},J[1].$0,J[1].$1.$0))):J[0]==""?ee.Dynamic(Ee,J[1].$0):(Ve=J[0],ee.Dynamic(Ee,O.Map(function(ke){return Ve+ke},J[1].$0))):ce.Create(Ee,J[0]))})()}),[C.DeleteEmptyFields({Els:r,Dirty:!0,Holes:l,Attrs:$,Render:(o=A.length==0?{$:1,$0:function(){V()}}:{$:1,$0:function(N){V(),c.iter(function(k){k(N)},A)}},o?o.$0:void 0),El:(u=!y.Equals(r,null)&&r.length===1&&c.get(r,0)instanceof Qe&&c.get(r,0)instanceof xn&&(a=c.get(r,0),!0)?{$:1,$0:a}:null,u?u.$0:void 0)},["Render","El"]),be.TreeReduce(O.Const(),O.Map2Unit,f)]},v.GlobalHoles=function(){return fe.$cctor(),fe.GlobalHoles},v.FakeRootSingle=function(t){var n,r,i,o;return t.removeAttribute("ws-template"),n=t.getAttribute("ws-replace"),n==null||(t.removeAttribute("ws-replace"),r=t.parentNode,y.Equals(r,null)||(i=self.document.createElement(t.tagName),i.setAttribute("ws-replace",n),r.replaceChild(i,t))),o=self.document.createElement("div"),o.appendChild(t),o},v.FakeRoot=function(t){var n;for(n=self.document.createElement("div");t.hasChildNodes();)n.appendChild(t.firstChild);return n},v.FakeRootFromHTMLTemplate=function(t){var n,r,i,o;for(n=self.document.createElement("div"),r=t.content,i=0,o=r.childNodes.length-1;i<=o;i++)n.appendChild(r.childNodes[i].cloneNode(!0));return n},v.TextHoleRE=function(){return fe.$cctor(),fe.TextHoleRE},v.foreachNotPreservedwsDOM=function(t,n){ae.IterSelectorDoc(t,function(r){r.closest("[ws-preserve]")==null&&n(r)})},W.Static=function(t){return new ce({$:3,$0:t})},W.Insert=function(t,n){var r,i,o;function u(a){for(var l,f;;)if(a!==null){if(a!=null&&a.$==1)return r.push(a.$0);if(a!=null&&a.$==2)l=a.$1,f=a.$0,u(f),a=l;else return a!=null&&a.$==3?a.$0(t):a!=null&&a.$==4?i.push(a.$0):null}else return null}return r=[],i=[],u(n),o=r.slice(0),Kt.New(t,W.Flags(n),o,i.length===0?null:{$:1,$0:function(a){b.iter(function(l){l(a)},i)}})},W.Updates=function(t){return be.MapTreeReduce(function(n){return n.NChanged()},O.Const(),O.Map2Unit,t.DynNodes)},W.Empty=function(t){return Kt.New(t,0,[],null)},W.AppendTree=function(t,n){var r;return t===null?n:n===null?t:(r=new ce({$:2,$0:t,$1:n}),W.SetFlags(r,W.Flags(t)|W.Flags(n)),r)},W.EmptyAttr=function(){return R.$cctor(),R.EmptyAttr},W.Flags=function(t){return t!==null&&t.hasOwnProperty("flags")?t.flags:0},W.Dynamic=function(t,n){return new ce({$:1,$0:new Mt.New(t,n)})},W.HasExitAnim=function(t){var n;return n=2,(t.DynFlags&n)===n},W.GetExitAnim=function(t){return W.GetAnim(t,function(n,r){return n.NGetExitAnim(r)})},W.HasEnterAnim=function(t){var n;return n=1,(t.DynFlags&n)===n},W.GetEnterAnim=function(t){return W.GetAnim(t,function(n,r){return n.NGetEnterAnim(r)})},W.HasChangeAnim=function(t){var n;return n=4,(t.DynFlags&n)===n},W.GetChangeAnim=function(t){return W.GetAnim(t,function(n,r){return n.NGetChangeAnim(r)})},W.SetFlags=function(t,n){t.flags=n},W.GetAnim=function(t,n){return de.Concat(c.map(function(r){return n(r,t.DynElem)},t.DynNodes))},W.Sync=function(t,n){c.iter(function(r){r.NSync(t)},n.DynNodes)},ae.ParseHTMLIntoFakeRoot=function(t){var n,r,i,o,u;function a(l,f){for(var $;;){if(f===0)return l;$=f,l=l.lastChild,f=$-1}}return n=self.document.createElement("div"),ae.rhtml().test(t)?(r=(i=ae.rtagName().exec(t),y.Equals(i,null)?"":c.get(i,1).toLowerCase()),o=(u=ae.wrapMap()[r],u||ae.defaultWrap()),n.innerHTML=o[1]+t.replace(ae.rxhtmlTag(),"<$1></$2>")+o[2],a(n,o[0])):(n.appendChild(self.document.createTextNode(t)),n)},ae.rhtml=function(){return ge.$cctor(),ge.rhtml},ae.wrapMap=function(){return ge.$cctor(),ge.wrapMap},ae.defaultWrap=function(){return ge.$cctor(),ge.defaultWrap},ae.rxhtmlTag=function(){return ge.$cctor(),ge.rxhtmlTag},ae.rtagName=function(){return ge.$cctor(),ge.rtagName},ae.IterSelector=function(t,n,r){var i,o,u;for(i=t.querySelectorAll(n),o=0,u=i.length-1;o<=u;o++)r(i[o])},ae.ChildrenArray=function(t){var n,r,i;for(n=[],r=0,i=t.childNodes.length-1;r<=i;r++)n.push(t.childNodes[r]);return n},ae.IterSelectorDoc=function(t,n){var r,i,o;for(r=self.document.querySelectorAll(t),i=0,o=r.length-1;i<=o;i++)n(r[i])},ae.InsertAt=function(t,n,r){var i;r.parentNode===t&&n===(i=r.nextSibling,y.Equals(i,null)?null:i)||t.insertBefore(r,n)},ae.RemoveNode=function(t,n){n.parentNode===t&&t.removeChild(n)},ut.$cctor=function(){ut.$cctor=h.ignore,ut.counter=0},hn.New=function(t,n,r,i,o){return{Node:t,Left:n,Right:r,Height:i,Count:o}},at=ne.Pair=C.Class({Equals:function(t){return y.Equals(this.Key,t.Key)},GetHashCode:function(){return y.Hash(this.Key)},CompareTo0:function(t){return y.Compare(this.Key,t.Key)}},null,at),at.New=function(t,n){return new at({Key:t,Value:n})},dn.notPresent=function(){throw new Ue.New},Ye=g.DocElemNode=C.Class({Equals:function(t){return this.ElKey===t.ElKey},GetHashCode:function(){return this.ElKey}},null,Ye),Ye.New=function(t,n,r,i,o,u){var a;return new Ye((a={Attr:t,Children:n,El:i,ElKey:o},C.SetOptional(a,"Delimiters",r),C.SetOptional(a,"Render",u),a))},pn.fromSeq=function(t){var n;return n=c.ofSeq(b.map(function(r){return at.New(r[0],r[1])},b.distinctBy(function(r){return r[0]},b.rev(t)))),c.sortInPlace(n),Q.Build(n,0,n.length-1)},xt=H.Scheduler=C.Class({Fork:function(t){var n;n=this,this.robin.push(t),this.idle&&(this.idle=!1,h.setTimeout(function(){n.tick()},0))},tick:function(){var t,n,r;for(n=this,r=Wt.now(),t=!0;t;)this.robin.length===0?(this.idle=!0,t=!1):(this.robin.shift()(),Wt.now()-r>40&&(h.setTimeout(function(){n.tick()},0),t=!1))}},M,xt),xt.New=C.Ctor(function(){M.New.call(this),this.idle=!0,this.robin=[]},xt),$t.WriteLink=function(t,n){var r;return r=n.get_IsEmpty()?"":"?"+$t.WriteQuery(n),"/"+$t.Concat(t)+r},$t.Concat=function(t){var n,r;return n=[],r=!0,K.iter(function(i){L.IsNullOrEmpty(i)||(r?r=!1:n.push("/"),n.push(i))},t),L.Join("",c.ofSeq(n))},$t.WriteQuery=function(t){function n(r,i){return r+"="+i}return L.concat("&",b.map(function(r){return n(r[0],r[1])},ot.ToSeq(t)))},fe.$cctor=function(){fe.$cctor=h.ignore,fe.LoadedTemplates=new Ce.New$5,fe.LocalTemplatesLoaded=!1,fe.GlobalHoles=new Ce.New$5,fe.TextHoleRE="\\${([^}]+)}",fe.RenderedFullDocTemplate=null},he.convertTextNode=function(t){var n,r,i,o,u;for(n=null,r=0,i=t.textContent,o=new h.RegExp(v.TextHoleRE(),"g");n=o.exec(i),n!==null;)t.parentNode.insertBefore(self.document.createTextNode(_e.string(i,{$:1,$0:r},{$:1,$0:o.lastIndex-c.get(n,0).length-1})),t),r=o.lastIndex,u=self.document.createElement("span"),u.setAttribute("ws-replace",c.get(n,1).toLowerCase()),t.parentNode.insertBefore(u,t);o.lastIndex=0,t.textContent=_e.string(i,{$:1,$0:r},null)},he.failNotLoaded=function(t){me.warn("Instantiating non-loaded template",t)},he.fillTextHole=function(t,n,r){var i;return i=t.querySelector("[ws-replace]"),y.Equals(i,null)?(me.warn("Filling non-existent text hole",r),null):(i.parentNode.replaceChild(self.document.createTextNode(n),i),{$:1,$0:i.getAttribute("ws-replace")})},he.removeHolesExcept=function(t,n){function r(i){v.foreachNotPreserved(t,"["+i+"]",function(o){n.Contains(o.getAttribute(i))||o.removeAttribute(i)})}r("ws-attr"),r("ws-onafterrender"),r("ws-var"),v.foreachNotPreserved(t,"[ws-hole]",function(i){if(!n.Contains(i.getAttribute("ws-hole")))for(i.removeAttribute("ws-hole");i.hasChildNodes();)i.removeChild(i.lastChild)}),v.foreachNotPreserved(t,"[ws-replace]",function(i){n.Contains(i.getAttribute("ws-replace"))||i.parentNode.removeChild(i)}),v.foreachNotPreserved(t,"[ws-on]",function(i){i.setAttribute("ws-on",L.concat(" ",c.filter(function(o){return n.Contains(c.get(L.SplitChars(o,[":"],1),1))},L.SplitChars(i.getAttribute("ws-on"),[" "],1))))}),v.foreachNotPreserved(t,"[ws-attr-holes]",function(i){var o,u,a,l,f;for(o=L.SplitChars(i.getAttribute("ws-attr-holes"),[" "],1),u=0,a=o.length-1;u<=a;u++)l=c.get(o,u),i.setAttribute(l,(f=new h.RegExp(v.TextHoleRE(),"g"),i.getAttribute(l).replace(f,function($,A){return n.Contains(A)?$:""})))})},he.fillInstanceAttrs=function(t,n){var r,i,o,u,a;if(he.convertAttrs(n),r=n.nodeName.toLowerCase(),i=t.querySelector("[ws-attr="+r+"]"),y.Equals(i,null))me.warn("Filling non-existent attr hole",r);else for(i.removeAttribute("ws-attr"),o=0,u=n.attributes.length-1;o<=u;o++)a=n.attributes.item(o),a.name=="class"&&i.hasAttribute("class")?i.setAttribute("class",i.getAttribute("class")+" "+a.nodeValue):i.setAttribute(a.name,a.nodeValue)},he.mapHoles=function(t,n){function r(i){v.foreachNotPreserved(t,"["+i+"]",function(o){var u,a;u=(a=null,[n.TryGetValue(o.getAttribute(i).toLowerCase(),{get:function(){return a},set:function(l){a=l}}),a]),u[0]&&o.setAttribute(i,u[1])})}r("ws-hole"),r("ws-replace"),r("ws-attr"),r("ws-onafterrender"),r("ws-var"),v.foreachNotPreserved(t,"[ws-on]",function(i){i.setAttribute("ws-on",L.concat(" ",c.map(function(o){var u,a,l;return u=L.SplitChars(o,[":"],1),a=(l=null,[n.TryGetValue(c.get(u,1),{get:function(){return l},set:function(f){l=f}}),l]),a[0]?c.get(u,0)+":"+a[1]:o},L.SplitChars(i.getAttribute("ws-on"),[" "],1))))}),v.foreachNotPreserved(t,"[ws-attr-holes]",function(i){var o,u,a;for(o=L.SplitChars(i.getAttribute("ws-attr-holes"),[" "],1),u=0,a=o.length-1;u<=a;u++)(function(){var l;function f($,A){var P;return P=oe.KeyValue(A),$.replace(new h.RegExp("\\${"+P[0]+"}","ig"),"${"+P[1]+"}")}return l=c.get(o,u),i.setAttribute(l,C.Curried3(b.fold)(f)(i.getAttribute(l))(n))})()})},he.fill=function(t,n,r){for(;;)if(t.hasChildNodes())r=n.insertBefore(t.lastChild,r);else return null},he.convertAttrs=function(t){var n,r,i,o,u,a,l,f;function $(A){var P;P=t.getAttribute(A),P==null||t.setAttribute(A,P.toLowerCase())}for(n=t.attributes,r=[],i=[],o=[],u=0,a=n.length-1;u<=a;u++)l=n.item(u),L.StartsWith(l.nodeName,"ws-on")&&l.nodeName!="ws-onafterrender"&&l.nodeName!="ws-on"?(r.push(l.nodeName),i.push(_e.string(l.nodeName,{$:1,$0:5},null)+":"+l.nodeValue.toLowerCase())):!L.StartsWith(l.nodeName,"ws-")&&new h.RegExp(v.TextHoleRE()).test(l.nodeValue)&&(l.nodeValue=(f=new h.RegExp(v.TextHoleRE(),"g"),l.nodeValue.replace(f,function(A,P){return"${"+P.toLowerCase()+"}"})),o.push(l.nodeName));i.length!=0&&t.setAttribute("ws-on",L.concat(" ",i)),o.length!=0&&t.setAttribute("ws-attr-holes",L.concat(" ",o)),$("ws-hole"),$("ws-replace"),$("ws-attr"),$("ws-onafterrender"),$("ws-var"),c.iter(function(A){t.removeAttribute(A)},r)},_e.string=function(t,n,r){var i,o;return n==null?r!=null&&r.$==1?(i=r.$0,i<0?"":t.slice(0,i+1)):"":r==null?t.slice(n.$0):(o=r.$0,o<0?"":t.slice(n.$0,o+1))},Ie=g.Elt=C.Class({},Y,Ie),Ie.TreeNode=function(t,n){var r,i;function o(u,a){return W.Updates(a)}return r=Ze.Create(n),new Ie.New$1({$:6,$0:t},O.Map2Unit((i=c.map(function(u){return o(u[0],u[1])},t.Attrs),be.TreeReduce(O.Const(),O.Map2Unit,i)),r.v),c.get(t.Els,0),r)},Ie.New=function(t,n,r){var i,o;return i=I.CreateElemNode(t,n,r.docNode),o=Ze.Create(r.updates),new Ie.New$1({$:1,$0:i},O.Map2Unit(W.Updates(i.Attr),o.v),t,o)},Ie.New$1=C.Ctor(function(t,n,r,i){Y.New.call(this,t,n),this.docNode$1=t,this.updates$1=n,this.elt=r,this.rvUpdates=i},Ie),de.get_UseAnimations=function(){return we.UseAnimations()},de.Play=function(t){return H.Delay(function(){return H.Bind(de.Run(h.ignore,we.Actions(t)),function(){return we.Finalize(t),H.Return(null)})})},de.Append=function(t,n){return{$:0,$0:Ge.Append(t.$0,n.$0)}},de.Run=function(t,n){var r;function i(o){function u(a){return function(l){var f;return f=l-a,n.Compute(f),t(),f<=r?void h.requestAnimationFrame(function($){u(a)($)}):o()}}h.requestAnimationFrame(function(a){u(a)(a)})}return r=n.Duration,r===0?H.Zero():H.FromContinuations(function(o,u,a){return i.apply(null,[o,u,a])})},de.Concat=function(t){return{$:0,$0:Ge.Concat(b.map(we.List,t))}},de.get_Empty=function(){return{$:0,$0:Ge.Empty()}},zt.BatchUpdatesEnabled=function(){return kt.$cctor(),kt.BatchUpdatesEnabled},$n.StartProcessor=function(t){var n;function r(){return H.Delay(function(){return H.Bind(t,function(){var i;return i=n[0],y.Equals(i,1)?(n[0]=0,H.Zero()):y.Equals(i,2)?(n[0]=1,r()):H.Zero()})})}return n=[0],function(){var i;i=n[0],y.Equals(i,0)?(n[0]=1,H.Start(r(),null)):y.Equals(i,1)&&(n[0]=2)}},Kt.New=function(t,n,r,i){var o;return o={DynElem:t,DynFlags:n,DynNodes:r},C.SetOptional(o,"OnAfterRender",i),o},Q.OfSeq=function(t){var n;return n=c.ofSeq(b.distinct(t)),c.sortInPlace(n),Q.Build(n,0,n.length-1)},Q.Enumerate=function(t,n){function r(i,o){for(var u;;){if(i==null)return o.$==1?{$:1,$0:[o.$0[0],[o.$0[1],o.$1]]}:null;t?(u=i,i=u.Right,o=new ie({$:1,$0:[u.Node,u.Left],$1:o})):(u=i,i=u.Left,o=new ie({$:1,$0:[u.Node,u.Right],$1:o}))}}return b.unfold(function(i){return r(i[0],i[1])},[n,ie.Empty])},Q.Build=function(t,n,r){var i,o,u;return r-n+1<=0?null:(i=(n+r)/2>>0,o=Q.Build(t,n,i-1),u=Q.Build(t,i+1,r),Q.Branch(c.get(t,i),o,u))},Q.Branch=function(t,n,r){var i,o;return hn.New(t,n,r,1+(i=n==null?0:n.Height,o=r==null?0:r.Height,y.Compare(i,o)===1?i:o),1+(n==null?0:n.Count)+(r==null?0:r.Count))},Q.Add=function(t,n){return Q.Put(function(r,i){return i},t,n)},Q.Put=function(t,n,r){var i,o;return i=Q.Lookup(n,r),o=i[0],o==null?Q.Rebuild(i[1],Q.Branch(n,null,null)):Q.Rebuild(i[1],Q.Branch(t(o.Node,n),o.Left,o.Right))},Q.Lookup=function(t,n){var r,i,o,u;for(r=[],i=n,o=!0;o;)i==null?o=!1:(u=y.Compare(t,i.Node),u===0?o=!1:u===1?(r.unshift([!0,i.Node,i.Left]),i=i.Right):(r.unshift([!1,i.Node,i.Right]),i=i.Left));return[i,r]},Q.Rebuild=function(t,n){var r,i,o,u,a,l,f,$,A,P;function S(x){return x==null?0:x.Height}for(r=n,i=0,o=c.length(t)-1;i<=o;i++)r=(u=c.get(t,i),u[0]?(a=u[1],l=u[2],S(r)>S(l)+1?S(r.Left)===S(r.Right)+1?(f=r.Left,Q.Branch(f.Node,Q.Branch(a,l,f.Left),Q.Branch(r.Node,f.Right,r.Right))):Q.Branch(r.Node,Q.Branch(a,l,r.Left),r.Right):Q.Branch(a,l,r)):($=u[1],A=u[2],S(r)>S(A)+1?S(r.Right)===S(r.Left)+1?(P=r.Right,Q.Branch(P.Node,Q.Branch(r.Node,r.Left,P.Left),Q.Branch($,P.Right,A))):Q.Branch(r.Node,r.Left,Q.Branch($,r.Right,A)):Q.Branch($,r,A)));return r},xe.$cctor=function(){xe.$cctor=h.ignore,xe.noneCT=yn.New(!1,[]),xe.scheduler=new xt.New,xe.defCTS=[new Pt.New],xe.Zero=H.Return(),xe.GetCT=function(t){t.k({$:0,$0:t.ct})}},jt=j.Attribute=C.Class({get_Value:function(){return this.fillWith},get_Name:function(){return this.name}},ue,jt),Qt=j.Event=C.Class({get_Value:function(){return this.fillWith},get_Name:function(){return this.name}},ue,Qt),ee.Handler=function(t,n){return W.Static(function(r){r.addEventListener(t,function(i){return n(r)(i)},!1)})},ee.OnAfterRender=function(t){return new ce({$:4,$0:t})},ee.Dynamic=function(t,n){return W.Dynamic(n,function(r){return function(i){return r.setAttribute(t,i)}})},ee.Value=function(t){return ee.ValueWith(B.StringApply(),t)},ee.FloatValueUnchecked=function(t){return ee.ValueWith(B.FloatApplyUnchecked(),t)},ee.Checked=function(t){return ee.ValueWith(B.BoolCheckedApply(),t)},ee.DateTimeValue=function(t){return ee.ValueWith(B.DateTimeApplyUnchecked(),t)},ee.FileValue=function(t){return ee.ValueWith(B.FileApplyUnchecked(),t)},ee.ValueWith=function(t,n){var r;return r=t(n),ce.Append(W.Static(r[0]),ee.DynamicCustom(r[1],r[2]))},ee.DynamicCustom=function(t,n){return W.Dynamic(n,t)},Jt=j.EventQ=C.Class({get_Value:function(){return this.fillWith},get_Name:function(){return this.name}},ue,Jt),Yt=j.AfterRender=C.Class({get_Value:function(){return this.fillWith},get_Name:function(){return this.name}},ue,Yt),Zt=j.AfterRenderQ=C.Class({get_Value:function(){return this.fillWith},get_Name:function(){return this.name}},ue,Zt),Ze=g.Updates=C.Class({},null,Ze),Ze.Create=function(t){var n;return n=null,n=Ze.New(t,null,function(){var r;return r=n.s,r===null&&(r=p.Copy(n.c()),n.s=r,p.WhenObsoleteRun(r,function(){n.s=null})),r}),n},Ze.New=function(t,n,r){return new Ze({c:t,s:n,v:r})},Ft=ne.ValueCollection=C.Class({GetEnumerator:function(){return U.Get(b.map(function(t){return t.V},this.d))}},M,Ft),Ft.New=C.Ctor(function(t){M.New.call(this),this.d=t},Ft),wn.New=function(t,n){return{PreviousNodes:t,Top:n}},$e.get_Empty=function(){return{$:0,$0:new se.New$3}},$e.FindAll=function(t){var n;function r(u,a){for(var l,f,$,A,P;;)switch(u){case 0:if(a!=null&&a.$==0)f=a.$1,$=a.$0,r(0,$),a=f;else if(a!=null&&a.$==1)A=a.$0,a=A,u=1;else if(a!=null&&a.$==2)P=a.$0,a=P.Current;else return a!=null&&a.$==6?(l=a.$0.Holes,function(S){return function(x){c.iter(S,x)}}(o)(l)):null;break;case 1:n.push(a),a=a.Children,u=0;break}}function i(u){return r(0,u)}function o(u){return r(1,u)}return n=[],i(t),{$:0,$0:new se.New$2(n)}},$e.Filter=function(t,n){return{$:0,$0:Fe.Filter(t,n.$0)}},$e.Except=function(t,n){return{$:0,$0:Fe.Except(t.$0,n.$0)}},$e.ToArray=function(t){return Fe.ToArray(t.$0)},$e.Intersect=function(t,n){return{$:0,$0:Fe.Intersect(t.$0,n.$0)}},we.UseAnimations=function(){return wt.$cctor(),wt.UseAnimations},we.Actions=function(t){return we.ConcatActions(c.choose(function(n){return n.$==1?{$:1,$0:n.$0}:null},Ge.ToArray(t.$0)))},we.Finalize=function(t){c.iter(function(n){n.$==0&&n.$0()},Ge.ToArray(t.$0))},we.ConcatActions=function(t){var n,r,i,o;return n=be.ofSeqNonCopying(t),r=c.length(n),r===0?we.Const():r===1?c.get(n,0):(i=b.max(b.map(function(u){return u.Duration},n)),o=c.map(function(u){return we.Prolong(i,u)},n),we.Def(i,function(u){c.iter(function(a){a.Compute(u)},o)}))},we.List=function(t){return t.$0},we.Const=function(t){return we.Def(0,function(){return t})},we.Def=function(t,n){return{Compute:n,Duration:t}},we.Prolong=function(t,n){var r,i,o;return r=n.Compute,i=n.Duration,o=yt.Create(function(){return n.Compute(n.Duration)}),{Compute:function(u){return u>=i?o.f():r(u)},Duration:t}},kt.$cctor=function(){kt.$cctor=h.ignore,kt.BatchUpdatesEnabled=!0},gn.Clear=function(t){t.splice(0,c.length(t))},b.insufficient=function(){return oe.FailWith("The input sequence has an insufficient number of elements.")},c.mapiInPlace=function(t,n){var r,i;for(r=0,i=n.length-1;r<=i;r++)n[r]=t(r,n[r]);return n},c.mapInPlace=function(t,n){var r,i;for(r=0,i=n.length-1;r<=i;r++)n[r]=t(n[r])},b.nonNegative=function(){return oe.FailWith("The input must be non-negative.")},Dt=ne.KeyCollection=C.Class({GetEnumerator:function(){return U.Get(b.map(function(t){return t.K},this.d))}},M,Dt),Dt.New=C.Ctor(function(t){M.New.call(this),this.d=t},Dt),Lt.concat=function(t){var n;n=[];for(var r in t)n.push.apply(n,t[r]);return n},yn.New=function(t,n){return{c:t,r:n}},Pt=d.CancellationTokenSource=C.Class({},M,Pt),Pt.New=C.Ctor(function(){M.New.call(this),this.c=!1,this.pending=null,this.r=[],this.init=1},Pt),Xt.New=function(t,n){return{k:t,ct:n}},ge.$cctor=function(){var t;ge.$cctor=h.ignore,ge.rxhtmlTag=new h.RegExp("<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\\w:]+)[^>]*)\\/>","gi"),ge.rtagName=new h.RegExp("<([\\w:]+)"),ge.rhtml=new h.RegExp("<|&#?\\w+;"),ge.wrapMap=(t=[1,"<table>","</table>"],{option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:t,tbody:t,tfoot:t,tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><colgroup>","</colgoup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"]}),ge.defaultWrap=[0,"",""]},wt.$cctor=function(){wt.$cctor=h.ignore,wt.CubicInOut=lt.Custom(function(t){var n;return n=t*t,3*n-2*(n*t)}),wt.UseAnimations=!0},Ge.Append=function(t,n){return t.$==0?n:n.$==0?t:{$:2,$0:t,$1:n}},Ge.ToArray=function(t){var n;function r(i){for(var o,u;;){if(i.$==1)return n.push(i.$0);if(i.$==2)o=i.$1,u=i.$0,r(u),i=o;else return i.$==3?c.iter(function(a){n.push(a)},i.$0):null}}return n=[],r(t),n.slice(0)},Ge.Concat=function(t){var n;return n=be.ofSeqNonCopying(t),be.TreeReduce(Ge.Empty(),Ge.Append,n)},Ge.Empty=function(){return Gt.$cctor(),Gt.Empty},R.$cctor=function(){var t,n,r,i,o,u,a,l,f,$,A,P,S,x;R.$cctor=h.ignore,R.EmptyAttr=null,R.BoolCheckedApply=function(E){function T(V,N){return N!=null&&N.$==1?void(V.checked=N.$0):null}return[function(V){V.addEventListener("change",function(){return E.Get()!=V.checked?E.Set(V.checked):null})},function(V){return function(N){return T(V,N)}},O.Map(function(V){return{$:1,$0:V}},E.get_View())]},R.StringSet=function(E){return function(T){E.value=T}},R.StringGet=function(E){return{$:1,$0:E.value}},R.StringApply=(t=B.StringGet(),n=B.StringSet(),function(E){return B.ApplyValue(t,n,E)}),R.DateTimeSetUnchecked=function(E){return function(T){E.value=new Wt(T).toLocaleString()}},R.DateTimeGetUnchecked=function(E){var T,V,N,k;return T=E.value,gt.isBlank(T)?{$:1,$0:-864e13}:(V=(N=0,[(k=Nn.TryParse(T),k!=null&&k.$==1&&(N=k.$0,!0)),N]),V[0]?{$:1,$0:V[1]}:null)},R.DateTimeApplyUnchecked=(r=B.DateTimeGetUnchecked(),i=B.DateTimeSetUnchecked(),function(E){return B.ApplyValue(r,i,E)}),R.FileSetUnchecked=function(){return function(){return null}},R.FileGetUnchecked=function(E){var T;return T=E.files,{$:1,$0:c.ofSeq(b.delay(function(){return b.map(function(V){return T.item(V)},oe.range(0,T.length-1))}))}},R.FileApplyUnchecked=(o=B.FileGetUnchecked(),u=B.FileSetUnchecked(),function(E){return B.FileApplyValue(o,u,E)}),R.IntSetUnchecked=function(E){return function(T){E.value=h.String(T)}},R.IntGetUnchecked=function(E){var T,V;return T=E.value,gt.isBlank(T)?{$:1,$0:0}:(V=+T,V!==V>>0?null:{$:1,$0:V})},R.IntApplyUnchecked=(a=B.IntGetUnchecked(),l=B.IntSetUnchecked(),function(E){return B.ApplyValue(a,l,E)}),R.IntSetChecked=function(E){return function(T){var V;return V=T.get_Input(),E.value!=V?void(E.value=V):null}},R.IntGetChecked=function(E){var T,V,N;return T=E.value,{$:1,$0:gt.isBlank(T)?!E.checkValidity||E.checkValidity()?new Oe({$:2,$0:T}):new Oe({$:1,$0:T}):(V=(N=0,[qt.TryParseInt32(T,{get:function(){return N},set:function(k){N=k}}),N]),V[0]?new Oe({$:0,$0:V[1],$1:T}):new Oe({$:1,$0:T}))}},R.IntApplyChecked=(f=B.IntGetChecked(),$=B.IntSetChecked(),function(E){return B.ApplyValue(f,$,E)}),R.FloatSetUnchecked=function(E){return function(T){E.value=h.String(T)}},R.FloatGetUnchecked=function(E){var T,V;return T=E.value,gt.isBlank(T)?{$:1,$0:0}:(V=+T,h.isNaN(V)?null:{$:1,$0:V})},R.FloatApplyUnchecked=(A=B.FloatGetUnchecked(),P=B.FloatSetUnchecked(),function(E){return B.ApplyValue(A,P,E)}),R.FloatSetChecked=function(E){return function(T){var V;return V=T.get_Input(),E.value!=V?void(E.value=V):null}},R.FloatGetChecked=function(E){var T,V;return T=E.value,{$:1,$0:gt.isBlank(T)?!E.checkValidity||E.checkValidity()?new Oe({$:2,$0:T}):new Oe({$:1,$0:T}):(V=+T,h.isNaN(V)?new Oe({$:1,$0:T}):new Oe({$:0,$0:V,$1:T}))}},R.FloatApplyChecked=(S=B.FloatGetChecked(),x=B.FloatSetChecked(),function(E){return B.ApplyValue(S,x,E)})},Ue=d.KeyNotFoundException=C.Class({},en,Ue),Ue.New=C.Ctor(function(){Ue.New$1.call(this,"The given key was not present in the dictionary.")},Ue),Ue.New$1=C.Ctor(function(t){this.message=t,vt.setPrototypeOf(this,Ue.prototype)},Ue),Mt=g.DynamicAttrNode=C.Class({NChanged:function(){return this.updates},NGetExitAnim:function(t){return de.get_Empty()},NGetEnterAnim:function(t){return de.get_Empty()},NGetChangeAnim:function(t){return de.get_Empty()},NSync:function(t){this.dirty&&(this.push(t)(this.value),this.dirty=!1)}},M,Mt),Mt.New=C.Ctor(function(t,n){var r;r=this,M.New.call(this),this.push=n,this.value=void 0,this.dirty=!1,this.updates=O.Map(function(i){r.value=i,r.dirty=!0},t)},Mt),lt=g.Easing=C.Class({},M,lt),lt.Custom=function(t){return new lt.New(t)},lt.New=C.Ctor(function(t){M.New.call(this),this.transformTime=t},lt),Fe.Filter=function(t,n){return new se.New$2(c.filter(t,Fe.ToArray(n)))},Fe.Except=function(t,n){var r;return r=new se.New$2(Fe.ToArray(n)),r.ExceptWith(Fe.ToArray(t)),r},Fe.ToArray=function(t){var n;return n=c.create(t.Count(),void 0),t.CopyTo(n,0),n},Fe.Intersect=function(t,n){var r;return r=new se.New$2(Fe.ToArray(t)),r.IntersectWith(Fe.ToArray(n)),r},B.ApplyValue=function(t,n,r){var i;function o(u,a){return a==null?null:u(a.$0)}return i=null,[function(u){function a(){r.UpdateMaybe(function(l){var f;return i=t(u),i!=null&&i.$==1&&!y.Equals(i.$0,l)&&(f=[i,i.$0],!0)?f[0]:null})}u.addEventListener("change",a),u.addEventListener("input",a),u.addEventListener("keypress",a)},function(u){var a;return a=n(u),function(l){return o(a,l)}},O.Map(function(u){return i!=null&&i.$==1&&y.Equals(i.$0,u)&&(i.$0,!0)?null:{$:1,$0:u}},r.get_View())]},B.StringSet=function(){return R.$cctor(),R.StringSet},B.StringGet=function(){return R.$cctor(),R.StringGet},B.DateTimeSetUnchecked=function(){return R.$cctor(),R.DateTimeSetUnchecked},B.DateTimeGetUnchecked=function(){return R.$cctor(),R.DateTimeGetUnchecked},B.FileApplyValue=function(t,n,r){var i;function o(u,a){return a==null?null:u(a.$0)}return i=null,[function(u){u.addEventListener("change",function(){r.UpdateMaybe(function(a){var l;return i=t(u),i!=null&&i.$==1&&i.$0!==a&&(l=[i,i.$0],!0)?l[0]:null})})},function(u){var a;return a=n(u),function(l){return o(a,l)}},O.Map(function(u){return i!=null&&i.$==1&&y.Equals(i.$0,u)&&(i.$0,!0)?null:{$:1,$0:u}},r.get_View())]},B.FileSetUnchecked=function(){return R.$cctor(),R.FileSetUnchecked},B.FileGetUnchecked=function(){return R.$cctor(),R.FileGetUnchecked},B.IntSetUnchecked=function(){return R.$cctor(),R.IntSetUnchecked},B.IntGetUnchecked=function(){return R.$cctor(),R.IntGetUnchecked},B.IntSetChecked=function(){return R.$cctor(),R.IntSetChecked},B.IntGetChecked=function(){return R.$cctor(),R.IntGetChecked},B.FloatSetUnchecked=function(){return R.$cctor(),R.FloatSetUnchecked},B.FloatGetUnchecked=function(){return R.$cctor(),R.FloatGetUnchecked},B.FloatSetChecked=function(){return R.$cctor(),R.FloatSetChecked},B.FloatGetChecked=function(){return R.$cctor(),R.FloatGetChecked},B.StringApply=function(){return R.$cctor(),R.StringApply},B.FloatApplyUnchecked=function(){return R.$cctor(),R.FloatApplyUnchecked},B.BoolCheckedApply=function(){return R.$cctor(),R.BoolCheckedApply},B.DateTimeApplyUnchecked=function(){return R.$cctor(),R.DateTimeApplyUnchecked},B.FileApplyUnchecked=function(){return R.$cctor(),R.FileApplyUnchecked},gt.isBlank=function(t){return L.forall(Cn.IsWhiteSpace,t)},Oe=g.CheckedInput=C.Class({get_Input:function(){return this.$==1?this.$0:this.$==2?this.$0:this.$1}},null,Oe),Xe.Children=function(t,n){var r,i,o;if(n!=null&&n.$==1){for(o=[],r=n.$0[0].nextSibling;r!==n.$0[1];)o.push(r),r=r.nextSibling;return{$:0,$0:o}}else return{$:0,$0:c.init(t.childNodes.length,(i=t.childNodes,function(u){return i[u]}))}},Xe.Except=function(t,n){var r;return r=t.$0,{$:0,$0:c.filter(function(i){return c.forall(function(o){return i!==o},r)},n.$0)}},Xe.Iter=function(t,n){c.iter(t,n.$0)},Xe.DocChildren=function(t){var n;function r(i){for(var o,u,a,l;;)if(i!=null&&i.$==2)u=i.$0,i=u.Current;else{if(i!=null&&i.$==1)return n.push(i.$0.El);if(i==null)return null;if(i!=null&&i.$==5)return n.push(i.$0);if(i!=null&&i.$==4)return n.push(i.$0.Text);if(i!=null&&i.$==6)return o=i.$0.Els,function(f){return function($){c.iter(f,$)}}(function(f){f==null||f.constructor===vt?r(f):n.push(f)})(o);a=i.$1,l=i.$0,r(l),i=a}}return n=[],r(t.Children),{$:0,$0:be.ofSeqNonCopying(n)}},Cn.IsWhiteSpace=function(t){return t.match(new h.RegExp("\\s"))!==null},Nn.TryParse=function(t){var n;return n=Wt.parse(t),h.isNaN(n)?null:{$:1,$0:n}},qt.TryParse=function(t,n,r,i){var o,u;return o=+t,u=o===o-o%1&&o>=n&&o<=r,u&&i.set(o),u},Be=d.OperationCanceledException=C.Class({},en,Be),Be.New=C.Ctor(function(t){Be.New$1.call(this,"The operation was canceled.",null,t)},Be),Be.New$1=C.Ctor(function(t,n,r){this.message=t,this.inner=n,vt.setPrototypeOf(this,Be.prototype),this.ct=r},Be),yt.Create=function(t){return An.New(!1,t,yt.forceLazy)},yt.forceLazy=function(){var t;return t=this.v(),this.c=!0,this.v=t,this.f=yt.cachedLazy,t},yt.cachedLazy=function(){return this.v},Gt.$cctor=function(){Gt.$cctor=h.ignore,Gt.Empty={$:0}},An.New=function(t,n,r){return{c:t,v:n,f:r}},C.OnLoad(function(){w.Main()})})(self);typeof WebSharper<"u"&&(WebSharper.Runtime.ScriptBasePath="/Content/",WebSharper.Runtime.Start());
